<!DOCTYPE html>
<!-- saved from url=(0037)https://delta-optima-pec.netlify.app/ -->
<html lang="fr" data-theme="light" style="--vsc-domain: &quot;delta-optima-pec.netlify.app&quot;;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#2c5aa0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="PEC Tech 100%">
    <title>PEC Tech - Relev√©s Terrain 100% Conformes</title>

    <!-- Biblioth√®ques pour exports -->
    <script src="./PEC Tech - Relev√©s Terrain 100% Conformes_files/jspdf.umd.min.js.t√©l√©chargement"></script>
    <script src="./PEC Tech - Relev√©s Terrain 100% Conformes_files/xlsx.full.min.js.t√©l√©chargement"></script>
    <!-- Supabase client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.48.0/dist/umd/supabase.min.js"></script>


    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
        background: #f8f9fa;
        color: #333;
        line-height: 1.6;
      }

      .app-container {
        min-height: 100vh;
        background: white;
      }

      .screen {
        display: none;
        min-height: 100vh;
        animation: fadeIn 0.3s ease;
      }

      .screen.active {
        display: block;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .header {
        background: #2c5aa0;
        color: white;
        padding: 20px;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .header h1 {
        font-size: 24px;
        font-weight: bold;
      }

      .nav-button {
        position: absolute;
        left: 20px;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(255, 255, 255, 0.2);
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
      }

      .nav-button:hover {
        background: rgba(255, 255, 255, 0.3);
      }

      .content {
        padding: 30px;
        max-width: 1200px;
        margin: 0 auto;
      }

      .btn {
        display: inline-block;
        min-height: 50px;
        padding: 15px 25px;
        font-size: 16px;
        font-weight: 500;
        text-align: center;
        text-decoration: none;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        line-height: 1.4;
        min-width: 160px;
        position: relative;
        overflow: hidden;
      }

      .btn:active {
        transform: scale(0.96);
      }

      .btn-primary {
        background: #2c5aa0;
        color: white;
      }

      .btn-primary:hover {
        background: #1e3f73;
        transform: translateY(-2px);
      }

      .btn-success {
        background: #28a745;
        color: white;
      }

      .btn-success:hover {
        background: #1e7e34;
        transform: translateY(-2px);
      }

      .btn-secondary {
        background: #6c757d;
        color: white;
      }

      .btn-secondary:hover {
        background: #5a6268;
        transform: translateY(-2px);
      }

      .btn-warning {
        background: #ffc107;
        color: #212529;
      }

      .btn-warning:hover {
        background: #e0a800;
      }

      .btn-danger {
        background: #dc3545;
        color: white;
      }

      .btn-danger:hover {
        background: #c82333;
        transform: translateY(-2px);
      }

      .btn-small {
        padding: 8px 12px;
        font-size: 14px;
        margin-left: 10px;
        min-height: auto;
        min-width: auto;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin: 30px 0;
      }

      .stat-card {
        background: white;
        border: 2px solid #e9ecef;
        border-radius: 10px;
        padding: 25px;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .stat-number {
        font-size: 36px;
        font-weight: bold;
        color: #2c5aa0;
        margin-bottom: 8px;
      }

      .stat-label {
        font-size: 14px;
        color: #6c757d;
        font-weight: 500;
      }

      .progress-bar {
        background: #e9ecef;
        border-radius: 10px;
        height: 25px;
        margin: 20px 0;
        overflow: hidden;
      }

      .progress-fill {
        background: linear-gradient(90deg, #28a745, #20c997);
        height: 100%;
        transition: width 0.8s ease;
        border-radius: 10px;
      }

      .lots-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin: 30px 0;
      }

      .lot-card {
        background: white;
        border: 2px solid #e9ecef;
        border-radius: 10px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }

      .lot-card:hover {
        border-color: #2c5aa0;
        transform: translateY(-5px);
        box-shadow: 0 8px 24px rgba(44, 90, 160, 0.12);
      }

      .lot-card.completed {
        border-color: #28a745;
        background: linear-gradient(135deg, #d4edda, #f8f9fa);
      }

      .lot-card.in-progress {
        border-color: #ffc107;
        background: linear-gradient(135deg, #fff3cd, #f8f9fa);
      }

      .lot-title {
        font-size: 16px;
        font-weight: bold;
        color: #333;
        margin-bottom: 10px;
      }

      .lot-progress {
        font-size: 14px;
        color: #6c757d;
        margin-bottom: 10px;
      }

      .badge {
        display: inline-block;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: bold;
        text-transform: uppercase;
      }

      .badge-success {
        background: #28a745;
        color: white;
      }

      .badge-primary {
        background: #007bff;
        color: white;
      }

      .badge-warning {
        background: #ffc107;
        color: #212529;
      }

      .badge-secondary {
        background: #6c757d;
        color: white;
      }

      .equipment-list {
        margin: 30px 0;
      }

      .equipment-card {
        background: white;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 20px;
        margin: 15px 0;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }

      .equipment-card:hover {
        border-color: #2c5aa0;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
      }

      .equipment-info h3 {
        color: #333;
        margin-bottom: 8px;
      }

      .equipment-details {
        font-size: 14px;
        color: #6c757d;
      }

      .form-container {
        background: white;
        border-radius: 10px;
        padding: 30px;
        margin: 20px 0;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .form-section {
        margin: 30px 0;
        padding: 25px;
        background: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid #2c5aa0;
      }

      .form-section h3 {
        color: #2c5aa0;
        margin-bottom: 20px;
        font-size: 18px;
      }

      .form-section h4 {
        margin: 20px 0 15px 0;
        font-size: 16px;
      }

      .form-group {
        margin: 20px 0;
      }

      .form-group label {
        display: block;
        font-weight: 600;
        margin-bottom: 8px;
        color: #333;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 12px;
        border: 2px solid #e9ecef;
        border-radius: 5px;
        font-size: 16px;
        transition: border-color 0.2s ease;
      }

      input:focus,
      select:focus,
      textarea:focus {
        outline: none;
        border-color: #2c5aa0;
      }

      input[readonly] {
        background-color: #e9ecef;
        font-weight: bold;
      }

      small {
        font-size: 12px;
        color: #6c757d;
        display: block;
        margin-top: 5px;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      .form-row-3 {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 15px;
      }

      .radio-group {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }

      .radio-option {
        background: white;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        padding: 15px;
        cursor: pointer;
        transition: all 0.2s ease;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .radio-option:hover {
        border-color: #2c5aa0;
      }

      .radio-option.selected {
        border-color: #2c5aa0;
        background: #e3f2fd;
      }

      .radio-option.ev-0 {
        border-color: #dc3545;
      }
      .radio-option.ev-1 {
        border-color: #fd7e14;
      }
      .radio-option.ev-2 {
        border-color: #ffc107;
      }
      .radio-option.ev-3 {
        border-color: #28a745;
      }
      .radio-option.ev-4 {
        border-color: #20c997;
      }

      .radio-option.crit-u {
        border-color: #dc3545;
      }
      .radio-option.crit-i {
        border-color: #fd7e14;
      }
      .radio-option.crit-a {
        border-color: #ffc107;
      }
      .radio-option.crit-s {
        border-color: #28a745;
      }

      .radio-option.type-c {
        border-color: #6610f2;
      }
      .radio-option.type-f {
        border-color: #dc3545;
      }
      .radio-option.type-v {
        border-color: #fd7e14;
      }
      .radio-option.type-s {
        border-color: #e83e8c;
      }
      .radio-option.type-m {
        border-color: #6c757d;
      }

      .radio-option.budget-a {
        border-color: #28a745;
      }
      .radio-option.budget-b {
        border-color: #20c997;
      }
      .radio-option.budget-c {
        border-color: #ffc107;
      }
      .radio-option.budget-d {
        border-color: #fd7e14;
      }
      .radio-option.budget-e {
        border-color: #dc3545;
      }

      .checkbox-group {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 10px;
        margin: 15px 0;
      }

      .checkbox-item {
        display: flex;
        align-items: center;
        padding: 10px;
        background: white;
        border: 1px solid #e9ecef;
        border-radius: 5px;
      }

      .checkbox-item input[type='checkbox'] {
        width: auto;
        margin-right: 10px;
      }

      .action-buttons {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin: 40px 0;
        padding: 20px 0;
        border-top: 1px solid #e9ecef;
      }

      .breadcrumb {
        background: #e9ecef;
        padding: 10px 15px;
        border-radius: 5px;
        margin-bottom: 20px;
        font-size: 14px;
      }

      .breadcrumb a {
        color: #2c5aa0;
        text-decoration: none;
        cursor: pointer;
      }

      .breadcrumb a:hover {
        text-decoration: underline;
      }

      .offline-banner {
        background: #ffc107;
        color: #000;
        padding: 10px;
        text-align: center;
        font-weight: bold;
        display: none;
      }

      .footer {
        background: #333;
        color: white;
        padding: 20px;
        text-align: center;
        font-size: 14px;
      }

      .hidden {
        display: none !important;
      }

      /* === NOUVEAUT√âS 100% CONFORMIT√â === */

      .photo-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 15px;
        margin-top: 15px;
      }

      .photo-item {
        position: relative;
        border: 2px solid #e9ecef;
        border-radius: 8px;
        overflow: hidden;
        aspect-ratio: 1;
      }

      .photo-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .photo-remove {
        position: absolute;
        top: 5px;
        right: 5px;
        background: #dc3545;
        color: white;
        border: none;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        cursor: pointer;
        font-size: 18px;
      }

      .priority-display {
        text-align: center;
        padding: 30px;
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        border-radius: 10px;
      }

      .priority-score {
        font-size: 48px;
        font-weight: bold;
        color: #2c5aa0;
      }

      .priority-label {
        font-size: 20px;
        font-weight: 600;
        margin-top: 10px;
      }

      /* === FLOATING ACTION BUTTON (FAB) === */
      .fab {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 64px;
        height: 64px;
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
        border: none;
        border-radius: 50%;
        font-size: 32px;
        font-weight: 300;
        cursor: pointer;
        box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .fab:hover {
        transform: scale(1.1) rotate(90deg);
        box-shadow: 0 8px 25px rgba(40, 167, 69, 0.6);
      }

      .fab:active {
        transform: scale(0.95) rotate(90deg);
      }

      .fab-icon {
        line-height: 1;
      }

      /* === TOAST NOTIFICATIONS === */
      .toast-container {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 10000;
        display: flex;
        flex-direction: column;
        gap: 10px;
        pointer-events: none;
      }

      .toast {
        background: #333;
        color: white;
        padding: 16px 24px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        font-size: 15px;
        animation:
          slideUp 0.3s ease,
          fadeOut 0.3s ease 2.7s;
        pointer-events: auto;
        min-width: 300px;
        text-align: center;
      }

      .toast.success {
        background: #28a745;
      }

      .toast.error {
        background: #dc3545;
      }

      .toast.info {
        background: #2c5aa0;
      }

      .toast.warning {
        background: #ffc107;
        color: #000;
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeOut {
        to {
          opacity: 0;
          transform: translateY(-10px);
        }
      }

      /* === RIPPLE EFFECT === */
      .ripple {
        position: absolute;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.6);
        transform: scale(0);
        animation: rippleEffect 0.6s ease-out;
        pointer-events: none;
      }

      @keyframes rippleEffect {
        to {
          transform: scale(4);
          opacity: 0;
        }
      }

      /* === RESPONSIVE === */
      @media (max-width: 768px) {
        .content {
          padding: 20px;
        }

        .stats-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .lots-grid {
          grid-template-columns: 1fr;
        }

        .form-row,
        .form-row-3 {
          grid-template-columns: 1fr;
        }

        .radio-group {
          grid-template-columns: 1fr;
        }

        .action-buttons {
          flex-direction: column;
        }

        .btn {
          width: 100%;
          margin: 5px 0;
        }

        .fab {
          bottom: 20px;
          right: 20px;
          width: 56px;
          height: 56px;
          font-size: 28px;
        }

        .checkbox-group {
          grid-template-columns: 1fr;
        }
      }
    </style>
  <style>#clark-up {
  width: 0;
  height: 100%;
  position: fixed;
  top: 0;
  right: 0;
  z-index: 2147483647;
  border-top-left-radius: 36px;
  background-color: white;
  box-shadow: 0 0 5px #0000009e;
  transition: 0.5s;
  overflow: hidden;
}

@keyframes fadeIn {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

#clark-up-video {
  position: fixed;
  z-index: 2147483647;
  width: 0;
  height: 0;
  overflow: hidden;
  animation: fadeIn 0.75s;
}

#clark-up-video iframe {
  border: none;
}

#clark-up-countdown {
  position: fixed;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  z-index: 2147483647;
  left: 0;
  top: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}


#clark-up-countdown > div {
  font-size: 200px;
  background: black;
  color: white;
  text-align: center;
  border-radius: 50%;
  width: 300px;
  height: 300px;
  line-height: 300px;
}

#clark-up iframe {
  width: 100%;
  height: 100%;
  border: none;
}

#clark-up-spinner {
  width: 100%;
  position: fixed;
  background: rgba(0, 0, 0, .4);
  z-index: 2147483647;
  top: 0;
  left: 0;
  height: 100%;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  color: white;
}

#clark-up-spinner .spinner-container {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  align-items: center;
}

#clark-up-spinner .spinner-container .spin {
  width: 40px;
  height: 40px;
  vertical-align: text-bottom;
  border: 4px solid currentColor;
  border-right-color: transparent;
  border-radius: 50%;
  -webkit-animation: spin .75s linear infinite;
  animation: spin .75s linear infinite;
}

#clark-up-spinner .spinner-container .message {
  margin-top: 10px;
}

#clark-up-progress {
  width: 100%;
  position: fixed;
  background: rgba(0, 0, 0, .4);
  z-index: 2147483647;
  top: 0;
  left: 0;
  height: 100%;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  color: white;
}

#clark-up-progress .progress-container {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  align-items: center;
}

#clark-up-progress .progress-container progress {
  background: none;
}

#clark-up-progress .progress-container progress::-webkit-progress-value {
  background: black;
  border-top-left-radius: 5px;
  border-bottom-left-radius: 5px;
} 

#clark-up-progress .progress-container progress::-webkit-progress-bar {
  background: white;
  border-radius: 5px;
} 

#clark-up-spinner .spinner-container .message {
  margin-top: 10px;
}

#clark-up-progress .progress-container button {
  background: black;
  padding: 10px;
  border-radius: 8px;
  color: white;
  margin-top: 10px;
  font-size: 15px;
} 

@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style><style type="text/css">@import url('https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap');</style><link id="psono-css" rel="stylesheet" type="text/css" href="chrome-extension://gcmahhkjkpigcpfpmdjnbiakmbdegfeh/data/css/contentscript.css" media="all"></head>
  <body style="" cz-shortcut-listen="true">
    <div class="offline-banner" id="offlineBanner" style="display: none;">
      üì± Mode hors ligne - Les donn√©es seront synchronis√©es √† la reconnexion
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <div class="app-container">
      <!-- √âCRAN 1: DASHBOARD -->
      <div id="dashboard" class="screen active">
        <div class="header" style="position: relative">
          <h1>üèóÔ∏è PEC Tech - Conformit√© 100%</h1>
          <div style="position: absolute; right: 20px; top: 50%; transform: translateY(-50%)">
            <span id="onlineStatus">üü¢</span>
          </div>
        </div>

        <div class="content">
          <h2 style="text-align: center; color: #2c5aa0; margin-bottom: 30px">PEC La D√©fense - 21 000 m¬≤</h2>

          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-number" id="lotsInProgress">16 / 16</div>
              <div class="stat-label">Lots en cours</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="lotsCompleted">0 / 16</div>
              <div class="stat-label">Lots termin√©s</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="equipmentCount">48</div>
              <div class="stat-label">√âquipements saisis</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="photoCount">0</div>
              <div class="stat-label">Photos prises</div>
            </div>
          </div>

          <div class="progress-bar">
            <div class="progress-fill" id="globalProgress" style="width: 100%;"></div>
          </div>

          <div style="text-align: center; margin: 30px 0">
            <button class="btn btn-secondary" id="btnExports" style="margin: 5px;">üìä Import-Export</button>
            <button class="btn btn-secondary" id="btnJournalVisite" style="margin: 5px;">üìù Journal de Visite</button>
            <button class="btn btn-secondary" id="btnSyntheseKpis" style="margin: 5px;">üìä Synth√®se &amp; KPIs</button>
          </div>

          <h3 style="color: #333; margin: 30px 0 20px 0">üìã Aper√ßu des lots techniques :</h3>
          <div id="lotsList" class="lots-grid"><div class="lot-card completed">
            <div class="lot-title">Structure / GO</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">Enveloppe</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">Toitures</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">CVC Production</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">CVC Distribution</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">CVC √âmission</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">Ventilation</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">√âlectricit√© CFO</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">√âlectricit√© CFA/GTB</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">SSI</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">Plomberie</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">Ascenseurs</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">Locaux techniques</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">EnR</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">IoT</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div><div class="lot-card completed">
            <div class="lot-title">HSE</div>
            <div class="lot-progress">3 √©quipement(s)</div>
            <span class="badge badge-success">
              üîÑ En cours
            </span>
          </div></div>
        </div>
      </div>

      <!-- √âCRAN 2: LISTE √âQUIPEMENTS -->
      <div id="equipmentList" class="screen">
<!-- DASHBOARD -->
<div id="dashboard-screen" class="screen active" style="padding: 20px;">
  <h1 style="font-size: 22px; margin-bottom: 20px;">üè† DeltaOptimaPEC ‚Äî Accueil</h1>

  <div style="display: flex; flex-direction: column; gap: 15px;">
    <button style="padding: 12px; border-radius: 8px; background: #1f2937; color: white; font-size: 16px;"
            onclick="document.getElementById('dashboard-screen').style.display='none';">
      üîç D√©marrer un relev√©
    </button>

    <button style="padding: 12px; border-radius: 8px; background: #374151; color: white; font-size: 16px;"
            onclick="document.getElementById('dashboard-screen').style.display='none';">
      üìÇ Continuer un relev√©
    </button>

    <button style="padding: 12px; border-radius: 8px; background: #4b5563; color: white; font-size: 16px;"
            onclick="document.getElementById('dashboard-screen').style.display='none';">
      üìã Consulter les lots
    </button>

    <button style="padding: 12px; border-radius: 8px; background: #6b7280; color: white; font-size: 16px;"
            onclick="document.getElementById('dashboard-screen').style.display='none';">
      üîÑ Synchroniser
    </button>
  </div>
</div>
          
          <div class="header" style="position: relative">
          <button class="nav-button" id="btnRetourLots">‚Üê Accueil</button>
          <h1 id="currentLotTitle">Structure / GO</h1>
        </div>

        <div class="content">
          <div class="breadcrumb">
            <a id="breadcrumbHome2">Accueil</a> &gt;
            <span id="breadcrumbCurrentLot">Structure / GO</span>
          </div>

          <div style="text-align: center; margin: 20px 0">
            <button class="btn btn-success" id="btnAddEquipment">‚ûï Ajouter un √©quipement</button>
            <button class="btn btn-primary" id="btnMarkLotComplete" style="margin-left: 15px">‚úÖ Marquer le lot comme termin√©</button>
          </div>

          <!-- FAB (Floating Action Button) -->
          <button class="fab" id="fabAddEquipment" title="Ajouter un √©quipement">
            <span class="fab-icon">+</span>
          </button>

          <div id="equipmentGrid" class="equipment-list"><div class="equipment-card">
            <div class="equipment-info">
              <h3>Poutre</h3>
              <div class="equipment-details">
                STR-001-824351 | üü° Moyen
                
              </div>
            </div>
            <div style="display: flex; gap: 10px;">
              <button class="btn btn-secondary btn-small" onclick="editEquipment(&#39;str-go-001&#39;)">‚úèÔ∏è Modifier</button>
              <button class="btn btn-danger btn-small" onclick="deleteEquipment(&#39;str-go-001&#39;)">üóëÔ∏è Supprimer</button>
            </div>
          </div><div class="equipment-card">
            <div class="equipment-info">
              <h3>Voile</h3>
              <div class="equipment-details">
                STR-002-935122 | üü† Mauvais
                
              </div>
            </div>
            <div style="display: flex; gap: 10px;">
              <button class="btn btn-secondary btn-small" onclick="editEquipment(&#39;str-go-002&#39;)">‚úèÔ∏è Modifier</button>
              <button class="btn btn-danger btn-small" onclick="deleteEquipment(&#39;str-go-002&#39;)">üóëÔ∏è Supprimer</button>
            </div>
          </div><div class="equipment-card">
            <div class="equipment-info">
              <h3>Dalle</h3>
              <div class="equipment-details">
                STR-003-772914 | üü¢ Bon
                
              </div>
            </div>
            <div style="display: flex; gap: 10px;">
              <button class="btn btn-secondary btn-small" onclick="editEquipment(&#39;str-go-003&#39;)">‚úèÔ∏è Modifier</button>
              <button class="btn btn-danger btn-small" onclick="deleteEquipment(&#39;str-go-003&#39;)">üóëÔ∏è Supprimer</button>
            </div>
          </div><div class="equipment-card">
            <div class="equipment-info">
              <h3>XXX</h3>
              <div class="equipment-details">
                STR-106329 | -
                
              </div>
            </div>
            <div style="display: flex; gap: 10px;">
              <button class="btn btn-secondary btn-small" onclick="editEquipment(&#39;1763929148483&#39;)">‚úèÔ∏è Modifier</button>
              <button class="btn btn-danger btn-small" onclick="deleteEquipment(&#39;1763929148483&#39;)">üóëÔ∏è Supprimer</button>
            </div>
          </div></div>
        </div>
      </div>

      <!-- √âCRAN 3: FORMULAIRE √âQUIPEMENT 100% CONFORME -->
      <div id="equipmentForm" class="screen">
        <div class="header" style="position: relative">
          <button class="nav-button" id="btnRetourEquipments">‚Üê Retour</button>
          <h1>Relev√© √©quipement - 100% Conforme</h1>
        </div>

        <div class="content">
          <div class="form-container">
            <form id="equipForm">
              <!-- Section 1: Localisation (Toujours visible) -->
              <div class="form-section">
                <h3>üìç Projet &amp; Localisation</h3>

                <div class="form-group">
                  <label>Projet :</label>
                  <input type="text" id="formProjet" value="PEC La D√©fense - 21 000 m¬≤" readonly="">
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Date visite :</label>
                    <input type="date" id="formDate">
                  </div>
                  <div class="form-group">
                    <label>Technicien :</label>
                    <input type="text" id="formTechnicien" placeholder="Nom du technicien">
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Heure d√©but :</label>
                    <input type="time" id="formHeureDebut">
                  </div>
                  <div class="form-group">
                    <label>Heure fin :</label>
                    <input type="time" id="formHeureFin">
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Entreprise :</label>
                    <input type="text" id="formEntreprise" placeholder="Nom de l&#39;entreprise">
                  </div>
                  <div class="form-group">
                    <label>Contact sur site :</label>
                    <input type="text" id="formContactSite" placeholder="R√©f√©rent sur site">
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>T√©l√©phone r√©f√©rent :</label>
                    <input type="tel" id="formTelReferent" placeholder="Ex: 06 12 34 56 78" style="background-image: url(&quot;data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiByeD0iNCIgZmlsbD0iI0I0QjRCNCIvPgo8cGF0aCBkPSJNOC4wMDAwMyAyLjVDNy4zODUyOCAyLjUgNi44MTIwOSAyLjY3MjY1IDYuMzI0MTQgMi45NzIyM0M2LjA4ODgxIDMuMTE2NzIgNS43ODA5MiAzLjA0MzA3IDUuNjM2NDMgMi44MDc3NEM1LjQ5MTk1IDIuNTcyNDIgNS41NjU1OSAyLjI2NDUyIDUuODAwOTIgMi4xMjAwNEM2LjQ0MTU5IDEuNzI2NjkgNy4xOTUxNSAxLjUgOC4wMDAwMyAxLjVDOS40ODE5NiAxLjUgMTAuNzg0MyAyLjI2NzA4IDExLjUzNjMgMy40MjM2OEwxMS41NDA4IDMuNDMwMThDMTEuNTQ3MyAzLjQzOTY3IDExLjU1NTggMy40NTI0IDExLjU2NjIgMy40NjgyN0MxMS41ODY4IDMuNDk5OTggMTEuNjE0NSAzLjU0NDM0IDExLjY0NyAzLjYwMDQ2QzExLjcxMTggMy43MTI1NCAxMS43OTYgMy44NzI2MSAxMS44Nzk3IDQuMDczN0MxMi4wNDY4IDQuNDc0NjggMTIuMjE2IDUuMDQ3ODkgMTIuMjIgNS43MzMyOEwxMi4yMiA1LjczNjIxQzEyLjIyIDcuOTQxNzggMTAuNTM5OCA5Ljc1NjYzIDguMzkwNjIgOS45NTQ1M1YxMi40NDZDOC45ODMzMiAxMi4zODI2IDkuNTA0NzggMTIuMjY0MiA5LjgyMTQyIDEyLjExMDNDMTAuMDY5OCAxMS45ODk2IDEwLjM2OSAxMi4wOTMgMTAuNDg5NyAxMi4zNDE0QzEwLjYxMDQgMTIuNTg5NyAxMC41MDcgMTIuODg4OSAxMC4yNTg2IDEzLjAwOTdDOS43NzM1NSAxMy4yNDU1IDkuMDc4ODkgMTMuMzg1MiA4LjM5MDYyIDEzLjQ1MTFWMTRDOC4zOTA2MiAxNC4yNzYxIDguMTY2NzYgMTQuNSA3Ljg5MDYyIDE0LjVDNy42MTQ0OCAxNC41IDcuMzkwNjIgMTQuMjc2MSA3LjM5MDYyIDE0VjkuNDcyNDNDNy4zOTA2MiA5LjE5NjI4IDcuNjE0NDggOC45NzI0MyA3Ljg5MDYyIDguOTcyNDNIOC4wMDAwM0M5Ljc3NTg1IDguOTcyNDMgMTEuMjE5MiA3LjUyNjM3IDExLjIyIDUuNzM3NjlDMTEuMjE2NyA1LjIxMzY0IDExLjA4NjkgNC43NzA5MSAxMC45NTY2IDQuNDU4MjNDMTAuODkxNyA0LjMwMjM0IDEwLjgyNzYgNC4xODEwNiAxMC43ODEzIDQuMTAxMDVDMTAuNzU4MiA0LjA2MTEyIDEwLjczOTcgNC4wMzE3MyAxMC43MjggNC4wMTM3MkMxMC43MjIyIDQuMDA0NzMgMTAuNzE4IDMuOTk4NiAxMC43MTU4IDMuOTk1NDRMMTAuNzE0NSAzLjk5MzQzTDEwLjcxNDIgMy45OTMwOEMxMC43MSAzLjk4NzEgMTAuNzA1OCAzLjk4MTAyIDEwLjcwMTkgMy45NzQ4NkMxMC4xMjY1IDMuMDg1NDcgOS4xMzA3NSAyLjUgOC4wMDAwMyAyLjVaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNS4wNzMzMiAzLjM3NjEzQzUuMzA5ODMgMy41MTg2NiA1LjM4NjAzIDMuODI1OTQgNS4yNDM1IDQuMDYyNDZDNC45NDk0OCA0LjU1MDM2IDQuNzgwMDMgNS4xMjI1OCA0Ljc4MDAzIDUuNzM2MjFWOS42Mzg1NkM0Ljc4MDAzIDkuOTE0NyA0LjU1NjE3IDEwLjEzODYgNC4yODAwMyAxMC4xMzg2QzQuMDAzODkgMTAuMTM4NiAzLjc4MDAzIDkuOTE0NyAzLjc4MDAzIDkuNjM4NTZWNS43MzYyMUMzLjc4MDAzIDQuOTM1ODUgNC4wMDE2MiA0LjE4NTgxIDQuMzg2OTkgMy41NDYzMUM0LjUyOTUyIDMuMzA5OCA0LjgzNjggMy4yMzM2IDUuMDczMzIgMy4zNzYxM1oiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik04LjAwMDA0IDQuMjUzOTdDNy4xODY0MiA0LjI1Mzk3IDYuNTI2ODYgNC45MTM1NCA2LjUyNjg2IDUuNzI3MTZWMTIuMDJDNi41MjY4NiAxMi4yOTYyIDYuMzAzIDEyLjUyIDYuMDI2ODYgMTIuNTJDNS43NTA3MSAxMi41MiA1LjUyNjg2IDEyLjI5NjIgNS41MjY4NiAxMi4wMlY1LjcyNzE2QzUuNTI2ODYgNC4zNjEyNSA2LjYzNDE0IDMuMjUzOTcgOC4wMDAwNCAzLjI1Mzk3QzkuMzY1OTUgMy4yNTM5NyAxMC40NzMyIDQuMzYxMjUgMTAuNDczMiA1LjcyNzE2QzEwLjQ3MzIgNy4wOTMwNiA5LjM2NTk1IDguMjAwMzUgOC4wMDAwNCA4LjIwMDM1QzcuNzIzOSA4LjIwMDM1IDcuNTAwMDQgNy45NzY0OSA3LjUwMDA0IDcuNzAwMzVDNy41MDAwNCA3LjQyNDIgNy43MjM5IDcuMjAwMzUgOC4wMDAwNCA3LjIwMDM1QzguODEzNjYgNy4yMDAzNSA5LjQ3MzIzIDYuNTQwNzggOS40NzMyMyA1LjcyNzE2QzkuNDczMjMgNC45MTM1NCA4LjgxMzY2IDQuMjUzOTcgOC4wMDAwNCA0LjI1Mzk3WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==&quot;) !important; background-position: right 12px center !important; background-repeat: no-repeat !important; background-size: auto !important; cursor: auto !important;">
                  </div>
                  <div class="form-group">
                    <label>Conditions m√©t√©o :</label>
                    <select id="formMeteo">
                      <option value="">S√©lectionner...</option>
                      <option value="sec">‚òÄÔ∏è Sec</option>
                      <option value="pluie">üåßÔ∏è Pluie</option>
                      <option value="neige">‚ùÑÔ∏è Neige</option>
                      <option value="vent">üí® Vent fort</option>
                      <option value="autre">‚õÖ Autre</option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label>Type de visite :</label>
                  <select id="formTypeVisite">
                    <option value="">S√©lectionner...</option>
                    <option value="initiale">üîç Initiale PEC</option>
                    <option value="complementaire">‚ûï Compl√©mentaire</option>
                    <option value="specifique">üéØ Relev√©s sp√©cifiques</option>
                  </select>
                </div>

                <div class="form-group">
                  <label>Lot technique :</label>
                  <input type="text" id="formLot" readonly="" style="background-color: #e9ecef; font-weight: bold">
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Niveau/√âtage :</label>
                    <input type="text" id="formNiveau" placeholder="Ex: R+2, R-1">
                  </div>
                  <div class="form-group">
                    <label>Local/Zone :</label>
                    <input type="text" id="formLocal" placeholder="Ex: Chaufferie Nord">
                  </div>
                </div>

                <button type="button" class="btn btn-secondary" id="btnGPS">üìç Capturer GPS</button>
                <div id="gpsInfo" style="margin-top: 10px; font-size: 14px; color: #6c757d"></div>
              </div>

              <!-- Section 2: Identification √âTENDUE (100% Conforme) -->
              <div class="form-section">
                <h3>üîß Identification</h3>

                <div class="form-row">
                  <div class="form-group">
                    <label>Type √©l√©ment/√©quipement :</label>
                    <select id="formType"><option value="">S√©lectionner...</option><option value="Dalle">Dalle</option><option value="Poutre">Poutre</option><option value="Poteau">Poteau</option><option value="Voile">Voile</option><option value="Plancher">Plancher</option><option value="Autre">Autre</option><option value="Autre">‚ûï Autre (saisie libre)</option></select>
                    <input type="text" id="formTypeAutre" placeholder="Pr√©ciser le type..." style="display: block; margin-top: 10px;">
                  </div>
                  <div class="form-group">
                    <label>Code unique :</label>
                    <input type="text" id="formCode" readonly="" placeholder="Auto-g√©n√©r√©">
                  </div>
                </div>

                <!-- NOUVEAUT√â 100% : QR Code, DOE, Plan -->
                <div class="form-row">
                  <div class="form-group">
                    <label>QR Code / NFC :</label>
                    <div style="display: flex; align-items: center">
                      <input type="text" id="formQRCode" placeholder="Scanner ou saisir" style="flex: 1">
                      <button type="button" class="btn-small" onclick="scanQRCode()">üì∑ Scanner</button>
                    </div>
                  </div>
                  <div class="form-group">
                    <label>R√©f√©rence DOE :</label>
                    <input type="text" id="formRefDOE" placeholder="Ex: DOE-2024-001">
                  </div>
                </div>

                <div class="form-group">
                  <label>R√©f√©rence plan :</label>
                  <input type="text" id="formRefPlan" placeholder="Ex: PLAN-CVC-R+2">
                </div>

                <!-- Champs √©quipements m√©caniques -->
                <div id="mechanical-fields" class="hidden">
                  <div class="form-row">
                    <div class="form-group">
                      <label>Marque :</label>
                      <input type="text" id="formMarque" placeholder="Ex: Viessmann">
                    </div>
                    <div class="form-group">
                      <label>Mod√®le :</label>
                      <input type="text" id="formModele" placeholder="Ex: Vitocrossal 300">
                    </div>
                  </div>

                  <div class="form-group">
                    <label>N¬∞ s√©rie :</label>
                    <input type="text" id="formSerie" placeholder="N¬∞ s√©rie ou scan QR">
                  </div>

                  <div class="form-row">
                    <div class="form-group">
                      <label>Puissance :</label>
                      <input type="number" id="formPuissance" placeholder="500">
                    </div>
                    <div class="form-group">
                      <label>Unit√© :</label>
                      <select id="formUnite">
                        <option value="kW">kW</option>
                        <option value="kVA">kVA</option>
                        <option value="CV">CV</option>
                        <option value="m¬≥/h">m¬≥/h</option>
                        <option value="L">L</option>
                        <option value="bar">bar</option>
                        <option value="¬∞C">¬∞C</option>
                      </select>
                    </div>
                  </div>

                  <div class="form-group">
                    <label>Ann√©e fabrication :</label>
                    <input type="number" id="formAnnee" min="1950" max="2030" placeholder="2022">
                  </div>
                </div>

                <!-- Champs √©l√©ments structurels -->
                <div id="structural-fields" class="">
                  <h4 style="color: #2c5aa0; margin: 20px 0 15px 0">üîç Constats visuels</h4>
                  <div class="checkbox-group">
                    <div class="checkbox-item">
                      <input type="checkbox" id="constat-ras" value="RAS">
                      <label for="constat-ras">RAS (Rien √† signaler)</label>
                    </div>
                    <div class="checkbox-item">
                      <input type="checkbox" id="constat-fissures" value="Fissures">
                      <label for="constat-fissures">Fissures / microfissures</label>
                    </div>
                    <div class="checkbox-item">
                      <input type="checkbox" id="constat-infiltration" value="Infiltration">
                      <label for="constat-infiltration">Traces d'infiltration / humidit√©</label>
                    </div>
                    <div class="checkbox-item">
                      <input type="checkbox" id="constat-corrosion" value="Corrosion">
                      <label for="constat-corrosion">Corrosion apparente</label>
                    </div>
                    <div class="checkbox-item">
                      <input type="checkbox" id="constat-degradation" value="D√©gradation">
                      <label for="constat-degradation">D√©gradation g√©n√©rale</label>
                    </div>
                    <div class="checkbox-item">
                      <input type="checkbox" id="constat-joints" value="Joints">
                      <label for="constat-joints">Joints d√©grad√©s</label>
                    </div>
                  </div>
                  <div class="form-group">
                    <label>D√©tails des constats :</label>
                    <textarea id="formConstatsDetails" rows="3" placeholder="D√©crire pr√©cis√©ment les anomalies constat√©es..."></textarea>
                  </div>
                </div>
              </div>

              <!-- NOUVEAUT√â 100% : Photos & Documents -->
              <div class="form-section">
                <h3>üì∑ Photos &amp; Documents</h3>

                <div class="form-group">
                  <label>Ajouter des photos :</label>
                  <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <button type="button" class="btn btn-primary" onclick="takePhoto()" style="flex: 1;">
                      üì∏ Prendre une photo
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="document.getElementById(&#39;formPhotos&#39;).click()" style="flex: 1;">
                      üìÅ S√©lectionner fichiers
                    </button>
                  </div>
                  <input type="file" id="formPhotos" multiple="" accept="image/*" style="display: none;">
                  <input type="file" id="formPhotoCamera" accept="image/*" capture="environment" style="display: none;">
                  <small>Formats accept√©s : JPG, PNG, HEIC | Max 10 photos</small>
                </div>

                <div id="photoPreview" class="photo-grid"></div>
              </div>

              <!-- NOUVEAUT√â 100% : Tests Dynamiques CVC -->
              <div id="cvc-tests-section" class="form-section hidden">
                <h3>üî¨ Tests Dynamiques CVC</h3>

                <div class="form-row-3">
                  <div class="form-group">
                    <label>D√©bit d'air mesur√© (m¬≥/h) :</label>
                    <input type="number" id="formDebitAir" placeholder="5000">
                  </div>
                  <div class="form-group">
                    <label>Pression diff√©rentielle (Pa) :</label>
                    <input type="number" id="formPressionDiff" placeholder="120" step="0.1">
                  </div>
                  <div class="form-group">
                    <label>Taux de brassage (vol/h) :</label>
                    <input type="number" id="formTauxBrassage" placeholder="4" step="0.1">
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Loi d'eau actuelle :</label>
                    <input type="text" id="formLoiEau" placeholder="Ex: 70/40¬∞C √† -5¬∞C ext">
                  </div>
                  <div class="form-group">
                    <label>Courbe de chauffe :</label>
                    <select id="formCourbeChauffe">
                      <option value="">S√©lectionner...</option>
                      <option value="ok">‚úÖ Optimale</option>
                      <option value="ajuster">‚ö†Ô∏è √Ä ajuster</option>
                      <option value="ko">‚ùå Inadapt√©e</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- NOUVEAUT√â 100% : Constats Ventilation Sp√©cifiques -->
              <div id="ventilation-section" class="form-section hidden">
                <h3>üå¨Ô∏è Constats Ventilation Sp√©cifiques</h3>

                <div class="checkbox-group">
                  <div class="checkbox-item">
                    <input type="checkbox" id="vent-colmatage" value="Colmatage filtres">
                    <label for="vent-colmatage">Colmatage filtres</label>
                  </div>
                  <div class="checkbox-item">
                    <input type="checkbox" id="vent-corrosion" value="Corrosion √©changeurs">
                    <label for="vent-corrosion">Corrosion √©changeurs</label>
                  </div>
                  <div class="checkbox-item">
                    <input type="checkbox" id="vent-encrassement" value="Encrassement batteries">
                    <label for="vent-encrassement">Encrassement batteries</label>
                  </div>
                  <div class="checkbox-item">
                    <input type="checkbox" id="vent-fuites" value="Fuites r√©seau">
                    <label for="vent-fuites">Fuites r√©seau</label>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Contr√¥le d√©senfumage :</label>
                    <select id="formDesenfumage">
                      <option value="">S√©lectionner...</option>
                      <option value="ok">‚úÖ Conforme</option>
                      <option value="ko">‚ùå Non conforme</option>
                      <option value="na">N/A</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Test extraction (m¬≥/h) :</label>
                    <input type="number" id="formTestExtraction" placeholder="3000">
                  </div>
                </div>
              </div>

              <!-- NOUVEAUT√â 100% : Mesures √âlectriques D√©taill√©es -->
              <div id="elec-measures-section" class="form-section hidden">
                <h3>‚ö° Mesures √âlectriques D√©taill√©es</h3>

                <div class="form-row-3">
                  <div class="form-group">
                    <label>Tension L1 (V) :</label>
                    <input type="number" id="formTensionL1" placeholder="230" step="0.1">
                  </div>
                  <div class="form-group">
                    <label>Tension L2 (V) :</label>
                    <input type="number" id="formTensionL2" placeholder="230" step="0.1">
                  </div>
                  <div class="form-group">
                    <label>Tension L3 (V) :</label>
                    <input type="number" id="formTensionL3" placeholder="230" step="0.1">
                  </div>
                </div>

                <div class="form-row-3">
                  <div class="form-group">
                    <label>Cos œÜ mesur√© :</label>
                    <input type="number" id="formCosPhi" placeholder="0.92" step="0.01" min="0" max="1">
                  </div>
                  <div class="form-group">
                    <label>√âquilibrage phases (%) :</label>
                    <input type="number" id="formEquilibragePhases" placeholder="95" max="100">
                  </div>
                  <div class="form-group">
                    <label>Continuit√© terre (Œ©) :</label>
                    <input type="number" id="formContinuiteTerre" placeholder="&lt; 1" step="0.01">
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Contr√¥le diff√©rentiel :</label>
                    <select id="formControleDiff">
                      <option value="">S√©lectionner...</option>
                      <option value="ok">‚úÖ Fonctionnel (&lt; 30mA)</option>
                      <option value="lent">‚ö†Ô∏è D√©clenchement lent</option>
                      <option value="ko">‚ùå D√©faillant</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>√âtat protection :</label>
                    <select id="formEtatProtection">
                      <option value="">S√©lectionner...</option>
                      <option value="ok">‚úÖ Conforme</option>
                      <option value="partiel">‚ö†Ô∏è Partiel</option>
                      <option value="ko">‚ùå Absent</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- NOUVEAUT√â 100% : Essais SSI D√©taill√©s -->
              <div id="ssi-tests-section" class="form-section hidden">
                <h3>üö® Essais SSI D√©taill√©s</h3>

                <div class="form-row">
                  <div class="form-group">
                    <label>Test d√©tecteurs fum√©e :</label>
                    <select id="formTestDetecteursFumee">
                      <option value="">S√©lectionner...</option>
                      <option value="ok">‚úÖ Tous fonctionnels</option>
                      <option value="partiel">‚ö†Ô∏è Certains d√©faillants</option>
                      <option value="ko">‚ùå Non fonctionnels</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Test DM (d√©clencheurs manuels) :</label>
                    <select id="formTestDM">
                      <option value="">S√©lectionner...</option>
                      <option value="ok">‚úÖ Tous fonctionnels</option>
                      <option value="partiel">‚ö†Ô∏è Certains d√©faillants</option>
                      <option value="ko">‚ùå Non fonctionnels</option>
                    </select>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Temps √©vacuation mesur√© (min) :</label>
                    <input type="number" id="formTempsEvacuation" placeholder="3" step="0.5">
                  </div>
                  <div class="form-group">
                    <label>Temps √©vacuation r√©glementaire (min) :</label>
                    <input type="number" id="formTempsEvacRegl" placeholder="5" step="0.5">
                  </div>
                </div>

                <div class="form-group">
                  <label>Mise en s√©curit√© test√©e :</label>
                  <div class="checkbox-group">
                    <div class="checkbox-item">
                      <input type="checkbox" id="ssi-desenfumage" value="D√©senfumage">
                      <label for="ssi-desenfumage">D√©senfumage</label>
                    </div>
                    <div class="checkbox-item">
                      <input type="checkbox" id="ssi-ascenseurs" value="Ascenseurs">
                      <label for="ssi-ascenseurs">Arr√™t ascenseurs</label>
                    </div>
                    <div class="checkbox-item">
                      <input type="checkbox" id="ssi-ventilation" value="Ventilation">
                      <label for="ssi-ventilation">Arr√™t ventilation</label>
                    </div>
                    <div class="checkbox-item">
                      <input type="checkbox" id="ssi-portes" value="Portes coupe-feu">
                      <label for="ssi-portes">Fermeture portes CF</label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- NOUVEAUT√â 100% : Diagnostics HSE Complets -->
              <div id="hse-diag-section" class="form-section hidden">
                <h3>üõ°Ô∏è Diagnostics HSE Complets</h3>

                <h4 style="color: #dc3545; margin-top: 20px">Diagnostic Amiante</h4>
                <div class="form-row">
                  <div class="form-group">
                    <label>Amiante d√©tect√© :</label>
                    <select id="formAmianteDetecte">
                      <option value="">S√©lectionner...</option>
                      <option value="non">‚ùå Non d√©tect√©</option>
                      <option value="oui">‚ö†Ô∏è Pr√©sent</option>
                      <option value="suspect">üîç Mat√©riau suspect</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Localisation amiante :</label>
                    <input type="text" id="formAmianteLocal" placeholder="Ex: Faux plafond R+3">
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Type amiante :</label>
                    <input type="text" id="formAmianteType" placeholder="Ex: Chrysotile">
                  </div>
                  <div class="form-group">
                    <label>√âtat de conservation :</label>
                    <select id="formAmianteEtat">
                      <option value="">S√©lectionner...</option>
                      <option value="bon">‚úÖ Bon (EP=1)</option>
                      <option value="moyen">‚ö†Ô∏è Moyen (EP=2)</option>
                      <option value="degrade">‚ùå D√©grad√© (EP=3)</option>
                    </select>
                  </div>
                </div>

                <h4 style="color: #fd7e14; margin-top: 20px">Diagnostic Plomb</h4>
                <div class="form-row">
                  <div class="form-group">
                    <label>Plomb d√©tect√© :</label>
                    <select id="formPlombDetecte">
                      <option value="">S√©lectionner...</option>
                      <option value="non">‚ùå Non d√©tect√© (&lt; 1 mg/cm¬≤)</option>
                      <option value="oui">‚ö†Ô∏è Pr√©sent (‚â• 1 mg/cm¬≤)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Concentration (mg/cm¬≤) :</label>
                    <input type="number" id="formPlombConcentration" placeholder="0.5" step="0.1">
                  </div>
                </div>

                <h4 style="color: #6610f2; margin-top: 20px">Mesure Radon</h4>
                <div class="form-row">
                  <div class="form-group">
                    <label>Concentration radon (Bq/m¬≥) :</label>
                    <input type="number" id="formRadonConcentration" placeholder="150">
                  </div>
                  <div class="form-group">
                    <label>Seuil r√©glementaire (Bq/m¬≥) :</label>
                    <input type="number" id="formRadonSeuil" value="300" readonly="">
                  </div>
                </div>

                <h4 style="color: #20c997; margin-top: 20px">Contr√¥le L√©gionelle</h4>
                <div class="form-row">
                  <div class="form-group">
                    <label>Concentration (UFC/L) :</label>
                    <input type="number" id="formLegionelleConcentration" placeholder="500">
                  </div>
                  <div class="form-group">
                    <label>Seuil alerte (UFC/L) :</label>
                    <input type="number" id="formLegionelleSeuil" value="1000" readonly="">
                  </div>
                </div>

                <h4 style="color: #333; margin-top: 20px">DUER (Document Unique)</h4>
                <div class="form-group">
                  <label>Risques identifi√©s :</label>
                  <textarea id="formDUER" rows="3" placeholder="Lister les risques professionnels identifi√©s..."></textarea>
                </div>

                <div class="form-group">
                  <label>Date derni√®re mise √† jour DUER :</label>
                  <input type="date" id="formDUERDate">
                </div>
              </div>

              <!-- NOUVEAUT√â 100% : Donn√©es IoT / Capteurs -->
              <div id="iot-data-section" class="form-section hidden">
                <h3>üì° Donn√©es IoT / Capteurs</h3>

                <div class="form-row">
                  <div class="form-group">
                    <label>Protocole communication :</label>
                    <select id="formIoTProtocole">
                      <option value="">S√©lectionner...</option>
                      <option value="lorawan">LoRaWAN</option>
                      <option value="sigfox">Sigfox</option>
                      <option value="nbiot">NB-IoT</option>
                      <option value="wifi">Wi-Fi</option>
                      <option value="zigbee">Zigbee</option>
                      <option value="ble">Bluetooth LE</option>
                      <option value="modbus">Modbus</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Fr√©quence transmission :</label>
                    <input type="text" id="formIoTFrequence" placeholder="Ex: Toutes les 15 min">
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Serveur / Cloud :</label>
                    <input type="text" id="formIoTServeur" placeholder="Ex: AWS IoT Core">
                  </div>
                  <div class="form-group">
                    <label>Derni√®re remont√©e donn√©es :</label>
                    <input type="datetime-local" id="formIoTDerniereRemontee">
                  </div>
                </div>

                <div class="form-group">
                  <label>√âtat connexion :</label>
                  <select id="formIoTConnexion">
                    <option value="">S√©lectionner...</option>
                    <option value="ok">‚úÖ Connect√©</option>
                    <option value="intermittent">‚ö†Ô∏è Intermittent</option>
                    <option value="ko">‚ùå D√©connect√©</option>
                  </select>
                </div>
              </div>

              <!-- Section 3: Mesures objectives (√âquipements m√©caniques uniquement) -->
              <div id="measurements-section" class="form-section hidden">
                <h3>üìè Mesures Objectives</h3>

                <div class="form-row-3">
                  <div class="form-group">
                    <label>Temp√©rature d√©part (¬∞C) :</label>
                    <input type="number" id="formTempDepart" placeholder="60" step="0.1">
                  </div>
                  <div class="form-group">
                    <label>Temp√©rature retour (¬∞C) :</label>
                    <input type="number" id="formTempRetour" placeholder="40" step="0.1">
                  </div>
                  <div class="form-group">
                    <label>ŒîT calcul√© (¬∞C) :</label>
                    <input type="number" id="formDeltaT" readonly="" placeholder="Auto">
                  </div>
                </div>

                <div class="form-row-3">
                  <div class="form-group">
                    <label>Pression (bar) :</label>
                    <input type="number" id="formPression" placeholder="2.5" step="0.1">
                  </div>
                  <div class="form-group">
                    <label>Intensit√© moteur (A) :</label>
                    <input type="number" id="formIntensite" placeholder="15.2" step="0.1">
                  </div>
                  <div class="form-group">
                    <label>Niveau sonore (dB) :</label>
                    <input type="number" id="formNiveauSonore" placeholder="65" max="120">
                  </div>
                </div>

                <div class="form-group">
                  <label>D√©bit mesur√© (m¬≥/h) :</label>
                  <input type="number" id="formDebit" placeholder="1000" step="1">
                </div>
              </div>

              <!-- Section 4: Performance √©nerg√©tique -->
              <div id="energy-section" class="form-section hidden">
                <h3>‚ö° Performance √ânerg√©tique</h3>

                <div class="form-row">
                  <div class="form-group">
                    <label>Consommation relev√©e (kWh/an) :</label>
                    <input type="number" id="formConsommationReel" placeholder="25000">
                  </div>
                  <div class="form-group">
                    <label>Consommation th√©orique (kWh/an) :</label>
                    <input type="number" id="formConsommationTheo" placeholder="22000">
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>√âcart performance (%) :</label>
                    <input type="number" id="formEcartPerf" readonly="" placeholder="Auto-calcul√©">
                  </div>
                  <div class="form-group">
                    <label>Dur√©e de vie r√©siduelle (ans) :</label>
                    <input type="number" id="formDureeVie" placeholder="8" max="30">
                  </div>
                </div>
              </div>

              <!-- NOUVEAUT√â 100% : Production √ânergies Renouvelables -->
              <div id="enr-production-section" class="form-section hidden">
                <h3>‚ôªÔ∏è Production √ânergies Renouvelables</h3>

                <div class="form-row">
                  <div class="form-group">
                    <label>Production mesur√©e (kWh/an) :</label>
                    <input type="number" id="formEnRProduction" placeholder="50000">
                  </div>
                  <div class="form-group">
                    <label>Production pr√©visionnelle (kWh/an) :</label>
                    <input type="number" id="formEnRPrevisionnel" placeholder="48000">
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>Taux autoconsommation (%) :</label>
                    <input type="number" id="formEnRAutoconso" placeholder="65" max="100">
                  </div>
                  <div class="form-group">
                    <label>Injection r√©seau (kWh/an) :</label>
                    <input type="number" id="formEnRInjection" placeholder="17500">
                  </div>
                </div>

                <div class="form-group">
                  <label>Performance vs pr√©visionnel (%) :</label>
                  <input type="number" id="formEnRPerformance" readonly="" placeholder="Auto-calcul√©">
                </div>
              </div>

              <!-- Section 5: Contr√¥les r√©glementaires -->
              <div id="regulatory-section" class="form-section">
                <h3>üìã Contr√¥les R√©glementaires</h3>

                <div class="form-row">
                  <div class="form-group">
                    <label>Dernier contr√¥le :</label>
                    <input type="date" id="formDernierControle">
                  </div>
                  <div class="form-group">
                    <label>Organisme agr√©√© :</label>
                    <input type="text" id="formOrganisme" placeholder="Ex: Bureau Veritas">
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>N¬∞ rapport :</label>
                    <input type="text" id="formNumRapport" placeholder="RPT-2024-001">
                  </div>
                  <div class="form-group">
                    <label>Prochaine √©ch√©ance :</label>
                    <input type="date" id="formProchaineEcheance">
                  </div>
                </div>

                <div class="form-group">
                  <label>R√©serves √©mises :</label>
                  <select id="formReserves">
                    <option value="">S√©lectionner...</option>
                    <option value="non">Non</option>
                    <option value="oui">Oui</option>
                    <option value="na">N/A</option>
                  </select>
                </div>

                <div class="form-group">
                  <label>√âtat lev√©e r√©serves :</label>
                  <select id="formLeveeReserves">
                    <option value="">S√©lectionner...</option>
                    <option value="oui">Oui - Lev√©es</option>
                    <option value="non">Non - En attente</option>
                    <option value="encours">En cours</option>
                    <option value="na">N/A</option>
                  </select>
                </div>
              </div>

              <!-- Section 6: √âtat Visuel -->
              <div class="form-section">
                <h3>üëÄ √âtat Visuel (EV)</h3>

                <div class="radio-group">
                  <div class="radio-option ev-0" data-ev="0">
                    <strong>EV 0</strong><br>
                    Neuf / Tr√®s bon<br>
                    <small>&lt; 2 ans OU r√©vision compl√®te r√©cente</small>
                  </div>
                  <div class="radio-option ev-1" data-ev="1">
                    <strong>EV 1</strong><br>
                    Bon √©tat<br>
                    <small>100% fonctionnel, entretien √† jour</small>
                  </div>
                  <div class="radio-option ev-2" data-ev="2">
                    <strong>EV 2</strong><br>
                    Moyen<br>
                    <small>80-100% fonctionnel, usure acceptable</small>
                  </div>
                  <div class="radio-option ev-3" data-ev="3">
                    <strong>EV 3</strong><br>
                    Mauvais<br>
                    <small>50-80% fonctionnel, intervention &lt; 6 mois</small>
                  </div>
                  <div class="radio-option ev-4" data-ev="4">
                    <strong>EV 4</strong><br>
                    Critique<br>
                    <small>&lt; 50% fonctionnel OU risque s√©curit√©</small>
                  </div>
                </div>
              </div>

              <!-- Section 7: Criticit√© -->
              <div class="form-section">
                <h3>‚ö†Ô∏è Criticit√© (CRIT)</h3>

                <div class="radio-group">
                  <div class="radio-option crit-u" data-crit="U">
                    <strong>üî¥ U - URGENT</strong><br>
                    S√©curit√© / risque / non-conformit√© grave
                  </div>
                  <div class="radio-option crit-i" data-crit="I">
                    <strong>üü† I - IMPORTANT</strong><br>
                    √Ä planifier rapidement
                  </div>
                  <div class="radio-option crit-a" data-crit="A">
                    <strong>üü° A - AM√âLIORATION</strong><br>
                    Confort, performance, optimisation
                  </div>
                  <div class="radio-option crit-s" data-crit="S">
                    <strong>üü¢ S - SUIVI</strong><br>
                    Point √† recontr√¥ler plus tard
                  </div>
                </div>
              </div>

              <!-- Section 8: Type d'anomalie -->
              <div class="form-section">
                <h3>üè∑Ô∏è Type d'Anomalie (TYPE)</h3>

                <div class="radio-group">
                  <div class="radio-option type-c" data-type="C">
                    <strong>C - CONFORMIT√â</strong><br>
                    R√©glementaire
                  </div>
                  <div class="radio-option type-f" data-type="F">
                    <strong>F - FONCTIONNEMENT</strong><br>
                    Dysfonctionnement technique
                  </div>
                  <div class="radio-option type-v" data-type="V">
                    <strong>V - VISUEL</strong><br>
                    D√©gradation apparente
                  </div>
                  <div class="radio-option type-s" data-type="S">
                    <strong>S - S√âCURIT√â</strong><br>
                    Risque s√©curit√© personnes/biens
                  </div>
                  <div class="radio-option type-m" data-type="M">
                    <strong>M - MAINTENANCE</strong><br>
                    Entretien insuffisant
                  </div>
                </div>
              </div>

              <!-- Section 9: Estimation budg√©taire -->
              <div class="form-section">
                <h3>üí∞ Estimation Budg√©taire (BUDGET)</h3>

                <div class="radio-group">
                  <div class="radio-option budget-a" data-budget="A">
                    <strong>A - &lt; 500‚Ç¨</strong><br>
                    Mineure
                  </div>
                  <div class="radio-option budget-b" data-budget="B">
                    <strong>B - 500-2 000‚Ç¨</strong><br>
                    Faible
                  </div>
                  <div class="radio-option budget-c" data-budget="C">
                    <strong>C - 2 000-10 000‚Ç¨</strong><br>
                    Moyenne
                  </div>
                  <div class="radio-option budget-d" data-budget="D">
                    <strong>D - 10 000-50 000‚Ç¨</strong><br>
                    Importante
                  </div>
                  <div class="radio-option budget-e" data-budget="E">
                    <strong>E - &gt; 50 000‚Ç¨</strong><br>
                    Majeure
                  </div>
                </div>
              </div>

              <!-- NOUVEAUT√â 100% : Priorit√© Action AUTO-CALCUL√âE -->
              <div class="form-section">
                <h3>üéØ Priorit√© d'Action (Auto-calcul√©e)</h3>

                <div class="priority-display">
                  <div class="priority-score" id="priorityScore">-</div>
                  <div class="priority-label" id="priorityLabel">En attente de saisie</div>
                </div>

                <small style="text-align: center; display: block; margin-top: 15px">
                  Formule : (EV + 1) √ó poids CRIT √ó poids BUDGET<br>
                  EV 0 (Neuf) = priorit√© 1 | EV 4 (Critique) = priorit√© 5
                </small>
              </div>

              <!-- Section 10: Description de l'anomalie -->
              <div class="form-section">
                <h3>üìù Description de l'Anomalie</h3>

                <div class="form-group">
                  <label>Constat d√©taill√© :</label>
                  <textarea id="formConstat" rows="4" placeholder="D√©crire pr√©cis√©ment l&#39;anomalie constat√©e, les sympt√¥mes, les impacts..."></textarea>
                </div>
              </div>

              <!-- NOUVEAUT√â 100% : Espace Croquis/Sch√©ma Terrain -->
              <div class="form-section">
                <h3>üìê Espace Croquis / Sch√©ma Terrain</h3>
                
                <p style="color: #6c757d; font-size: 14px; margin-bottom: 15px;">
                  Dessinez l'implantation de l'√©quipement, le r√©seau de distribution, ou marquez les points singuliers.
                </p>
                
                <div style="text-align: center; margin-bottom: 10px;">
                  <button type="button" class="btn btn-secondary" onclick="clearCanvas()" style="margin-right: 10px;">üóëÔ∏è Effacer</button>
                  <button type="button" class="btn btn-secondary" onclick="changeDrawColor(&#39;black&#39;)">‚ö´ Noir</button>
                  <button type="button" class="btn btn-secondary" onclick="changeDrawColor(&#39;red&#39;)">üî¥ Rouge</button>
                  <button type="button" class="btn btn-secondary" onclick="changeDrawColor(&#39;blue&#39;)">üîµ Bleu</button>
                  <button type="button" class="btn btn-secondary" onclick="changeDrawColor(&#39;green&#39;)">üü¢ Vert</button>
                </div>
                
                <canvas id="croquisCanvas" style="border: 2px solid #dee2e6; border-radius: 8px; background: white; width: 100%; max-width: 600px; height: 400px; display: block; margin: 0 auto; touch-action: none;" width="600" height="400">
                </canvas>
              </div>

              <!-- Section 11: Observations du technicien -->
              <div class="form-section">
                <h3>üí¨ Observations Technicien</h3>

                <div class="form-group">
                  <label>Observations / Remarques :</label>
                  <textarea id="formObservations" rows="3" placeholder="Commentaires compl√©mentaires, contexte particulier..."></textarea>
                </div>
              </div>

              <!-- Section 12: Actions correctives recommand√©es -->
              <div class="form-section">
                <h3>üîß Actions Correctives Recommand√©es</h3>

                <div class="form-group">
                  <label>Actions √† mettre en ≈ìuvre :</label>
                  <textarea id="formActions" rows="4" placeholder="Lister les actions correctives recommand√©es, les travaux n√©cessaires..."></textarea>
                </div>
              </div>

              <!-- Boutons d'action -->
              <div class="action-buttons">
                <button type="button" class="btn btn-secondary" id="btnCancelForm">‚ùå Annuler</button>
                <button type="button" class="btn btn-success" id="btnSaveEquipment">
                  ‚úÖ Enregistrer l'√©quipement
                </button>
                <button type="button" class="btn btn-danger" id="btnDeleteEquipment" style="display: none;">
                  üóëÔ∏è Effacer la fiche
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- √âCRAN 4: EXPORTS & STATISTIQUES -->
      <div id="exports" class="screen">
        <div class="header" style="position: relative">
          <button class="nav-button" onclick="showScreen(&#39;dashboard&#39;); renderDashboard();">‚Üê Accueil</button>
          <h1>üìä Import-Export &amp; Statistiques</h1>
        </div>

        <div class="content">
          <h2 style="text-align: center; color: #2c5aa0; margin-bottom: 30px">Exportation des donn√©es</h2>

          <!-- NOUVEAU : Format de restitution souhait√© -->
          <div class="form-section" style="max-width: 800px; margin: 0 auto 30px auto;">
            <h3>üìã Format de Restitution Souhait√©</h3>
            <p style="color: #6c757d; font-size: 14px; margin-bottom: 15px;">
              S√©lectionnez le format d'export principal pour votre rapport de visite
            </p>
            <div class="form-group">
              <label for="formatRestitution">Format pr√©f√©r√© :</label>
              <select id="formatRestitution" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 5px; font-size: 16px;">
                <option value="csv">üìÑ Excel avec photos int√©gr√©es (CSV + Photos)</option>
                <option value="json">üíæ JSON complet (Backup r√©importable)</option>
                <option value="pdf">üìë PDF avec hyperliens photos</option>
                <option value="gmao">üîß Import GMAO (logiciel de maintenance)</option>
                <option value="bim">üèóÔ∏è Format BIM/IFC (maquette num√©rique)</option>
                <option value="cloud">‚òÅÔ∏è Plateforme collaborative (URL)</option>
              </select>
            </div>
            <div class="form-group" id="cloudUrlGroup" style="display: none;">
              <label for="cloudUrl">URL Plateforme Collaborative :</label>
              <input type="url" id="cloudUrl" placeholder="https://..." style="width: 100%;">
              <small>Exemple : https://votre-plateforme.com/projet/defense-21000</small>
            </div>
            <div class="form-group" id="gmaoLogicielGroup" style="display: none;">
              <label for="gmaoLogiciel">Nom du logiciel GMAO :</label>
              <input type="text" id="gmaoLogiciel" placeholder="Ex: CARL Source, Mainpro, Yardi..." style="width: 100%;">
            </div>
            <button class="btn btn-success" onclick="saveFormatRestitution()" style="margin-top: 10px;">üíæ Enregistrer la pr√©f√©rence</button>
          </div>

          <div style="text-align: center; margin: 40px 0">
            <button class="btn btn-success" onclick="exportCSVAndPhotos()">üìÑ Exporter CSV + üì¶ Photos (ZIP)</button>
            <button class="btn btn-primary" onclick="exportJSON()">üíæ Exporter JSON Complet</button>
          </div>
          
          <p style="text-align: center; color: #6c757d; font-size: 14px; margin: 20px 0;">
            ‚úÖ CSV : Ouverture directe dans Excel | ‚úÖ ZIP : Toutes les photos class√©es par lot | ‚úÖ JSON : Sauvegarde compl√®te r√©importable
          </p>

          <div style="border-top: 2px solid #e9ecef; padding-top: 40px; margin-top: 40px;">
            <h3 style="color: #333; text-align: center; margin-bottom: 20px;">üì• Importer des donn√©es (Restauration)</h3>
            
            <div style="text-align: center; margin: 30px 0;">
              <input type="file" id="importJSONFile" accept=".json" style="display: none;" onchange="handleJSONImport(event)">
              <button class="btn btn-warning" onclick="document.getElementById(&#39;importJSONFile&#39;).click()">
                üì• Importer JSON (Restaurer donn√©es)
              </button>
            </div>
            
            <p style="text-align: center; color: #6c757d; font-size: 14px; margin: 20px 0;">
              ‚ö†Ô∏è <strong>Attention :</strong> L'import √©crasera les donn√©es actuelles. Exportez d'abord si n√©cessaire.
            </p>
          </div>

          <h3 style="color: #333; margin: 40px 0 20px 0">üìà Statistiques d√©taill√©es par lot :</h3>

          <div id="statsDetails" style="margin: 30px 0">
            <!-- Rempli par JavaScript -->
          </div>

          <div style="text-align: center; margin: 40px 0">
            <h3 style="color: #333; margin: 40px 0 20px 0">üìä Synchronisation Google Sheets :</h3>
            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin: 20px 0">
              <button class="btn btn-primary" onclick="configureGoogleSheets()">‚öôÔ∏è Configurer Google Sheets</button>
              <button id="btnToggleGoogleSheets" class="btn btn-secondary" onclick="toggleGoogleSheets()" style="background-color: rgb(40, 167, 69);">‚úÖ Google Sheets Activ√©</button>
            </div>
            <p style="color: #6c757d; font-size: 14px; margin-top: 10px">
              Activez la synchronisation pour envoyer automatiquement les donn√©es vers Google Sheets
            </p>
            <button class="btn btn-secondary" onclick="clearAllData()" style="margin-top: 30px">üóëÔ∏è Effacer toutes les donn√©es</button>
          </div>
        </div>
      </div>

      <!-- √âCRAN 5: JOURNAL DE VISITE -->
      <div id="journalVisite" class="screen">
        <div class="header" style="position: relative">
          <button class="nav-button" onclick="showScreen(&#39;dashboard&#39;); renderDashboard();">‚Üê Accueil</button>
          <h1>üìù Journal de Visite</h1>
        </div>

        <div class="content">
          <h2 style="text-align: center; color: #2c5aa0; margin-bottom: 30px">√Ä compl√©ter pendant ou apr√®s la visite</h2>

          <div class="form-section">
            <h3>‚ö†Ô∏è Incidents de visite</h3>
            <p style="color: #6c757d; font-size: 14px;">Acc√®s refus√©, zone inaccessible, danger, probl√®me rencontr√©...</p>
            <textarea id="journalIncidents" rows="4" style="width: 100%; padding: 10px; border: 1px solid #dee2e6; border-radius: 5px;" placeholder="D√©crire les incidents..."></textarea>
          </div>

          <div class="form-section">
            <h3>üö´ Zones non visit√©es / partiellement visit√©es</h3>
            <p style="color: #6c757d; font-size: 14px;">Justifier pourquoi certaines zones n'ont pas pu √™tre audit√©es</p>
            <textarea id="journalZonesNonVisitees" rows="4" style="width: 100%; padding: 10px; border: 1px solid #dee2e6; border-radius: 5px;" placeholder="Zones non visit√©es et raisons..."></textarea>
          </div>

          <div class="form-section">
            <h3>üîç Points √† revoir / Seconde visite n√©cessaire</h3>
            <p style="color: #6c757d; font-size: 14px;">√âl√©ments n√©cessitant un contr√¥le compl√©mentaire</p>
            <textarea id="journalPointsARevoir" rows="4" style="width: 100%; padding: 10px; border: 1px solid #dee2e6; border-radius: 5px;" placeholder="Points √† recontr√¥ler..."></textarea>
          </div>

          <div style="text-align: center; margin: 30px 0">
            <button class="btn btn-success" onclick="saveJournalVisite()">üíæ Sauvegarder le journal</button>
          </div>
        </div>
      </div>

      <!-- √âCRAN 6: SYNTH√àSE & KPIs -->
      <div id="syntheseKpis" class="screen">
        <div class="header" style="position: relative">
          <button class="nav-button" onclick="showScreen(&#39;dashboard&#39;); renderDashboard();">‚Üê Accueil</button>
          <h1>üìä Synth√®se &amp; KPIs</h1>
        </div>

        <div class="content">
          
          <!-- SYNTH√àSE TERRAIN -->
          <h2 style="color: #2c5aa0; margin-bottom: 20px">üìù Synth√®se Terrain du Technicien</h2>

          <div class="form-section">
            <h3>‚úÖ Principales forces du site (techniquement)</h3>
            <textarea id="syntheseForces" rows="3" style="width: 100%; padding: 10px; border: 1px solid #dee2e6; border-radius: 5px;" placeholder="Points forts techniques..."></textarea>
          </div>

          <div class="form-section">
            <h3>‚ùå Principales faiblesses / risques imm√©diats</h3>
            <textarea id="syntheseFaiblesses" rows="3" style="width: 100%; padding: 10px; border: 1px solid #dee2e6; border-radius: 5px;" placeholder="Points faibles et risques..."></textarea>
          </div>

          <div class="form-section">
            <h3>üéØ Points √† traiter en priorit√©</h3>
            <textarea id="synthesePriorites" rows="3" style="width: 100%; padding: 10px; border: 1px solid #dee2e6; border-radius: 5px;" placeholder="Priorit√©s d&#39;action..."></textarea>
          </div>

          <div class="form-section">
            <h3>üí° Recommandations terrain</h3>
            <textarea id="syntheseRecommandations" rows="3" style="width: 100%; padding: 10px; border: 1px solid #dee2e6; border-radius: 5px;" placeholder="Recommandations pour l&#39;organisation, acc√®s, consignes..."></textarea>
          </div>

          <div style="text-align: center; margin: 30px 0">
            <button class="btn btn-success" onclick="saveSyntheseTerrain()">üíæ Sauvegarder la synth√®se</button>
          </div>

          <!-- SCORE DE SANT√â GLOBAL PAR LOT -->
          <div style="border-top: 2px solid #e9ecef; padding-top: 40px; margin-top: 40px;">
            <h2 style="color: #2c5aa0; margin-bottom: 20px">üè• Score de Sant√© Global par Lot</h2>
            <p style="color: #6c757d; margin-bottom: 20px;">Calcul√© automatiquement : Moyenne EV de tous les √©quipements du lot</p>
            
            <div id="scoresSanteLots" style="overflow-x: auto;">
              <!-- Table g√©n√©r√©e par JavaScript -->
            </div>
          </div>

          <!-- INDICATEURS DE PERFORMANCE -->
          <div style="border-top: 2px solid #e9ecef; padding-top: 40px; margin-top: 40px;">
            <h2 style="color: #2c5aa0; margin-bottom: 20px">üìà Indicateurs de Performance (KPIs)</h2>
            
            <div id="kpisContainer">
              <!-- KPIs g√©n√©r√©s par JavaScript -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- JAVASCRIPT COMPLET -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

    <script>
localStorage.clear();

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // CONFIGURATION GLOBALE
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      const LOTS_TECHNIQUES = [
        'Structure / GO',
        'Enveloppe',
        'Toitures',
        'CVC Production',
        'CVC Distribution',
        'CVC √âmission',
        'Ventilation',
        '√âlectricit√© CFO',
        '√âlectricit√© CFA/GTB',
        'SSI',
        'Plomberie',
        'Ascenseurs',
        'Locaux techniques',
        'EnR',
        'IoT',
        'HSE'
      ];

    const EQUIPEMENT_TYPES_BY_LOT = {
  'Structure / GO': ['Dalle', 'Poutre', 'Poteau', 'Voile', 'Plancher', 'Autre'],

  Enveloppe: ['Fa√ßade', 'Menuiserie', 'Garde-corps', 'Bardage', 'Autre'],

  Toitures: ['√âtanch√©it√©', 'Couverture', 'Charpente', 'Zinguerie', 'Autre'],

  'CVC Production': ['Chaudi√®re', 'Pompe √† chaleur', 'Groupe froid', 'Ballon ECS', 'Autre'],

  'CVC Distribution': ['R√©seau hydraulique', 'Pompe', 'Vanne', '√âchangeur', 'Autre'],

  'CVC √âmission': [
    'Radiateur',
    'Plancher chauffant',
    'Ventilo-convecteur',
    'Cassette',
    'Autre'
  ],

  Ventilation: ['CTA', 'VMC', 'Extracteur', 'R√©seau a√©raulique', 'Autre'],

  '√âlectricit√© CFO': ['TGBT', 'Tableau divisionnaire', '√âclairage', 'Prise', 'Autre'],

  '√âlectricit√© CFA/GTB': ['Armoire GTB', 'Automate', 'Capteur', 'Interface', 'Autre'],

  SSI: ['Centrale SSI', 'D√©tecteur', 'DM', 'BAAS', 'Autre'],

  // üîß Plomberie (mis √† jour)
  Plomberie: [
    'R√©seau EU',
    'R√©seau EP',
    'R√©seau ECS',
    'R√©seau EF',
    'Contr√¥le des compteurs d‚Äôeau',
    'Contr√¥le qualit√© d‚Äôeau',
    'Autre'
  ],

  // üîß CVC (ajouts compteurs + d√©bits + qualit√© eau)
  CVC: [
    'CTA',
    'Ventilo-convecteur',
    'Cassette',
    'Relev√© des d√©bits d‚Äôair dans les sanitaires',
    'Contr√¥le des compteurs d‚Äôeau',
    'Contr√¥le qualit√© d‚Äôeau',
    'Autre'
  ],

  Ascenseurs: ['Ascenseur', 'Monte-charge', 'Autre'],

  'Locaux techniques': ['Local CVC', 'Local √©lectrique', 'Local SSI', 'Autre'],

  EnR: ['Panneaux PV', '√âolienne', 'G√©othermie', 'Solaire thermique', 'Autre'],

  IoT: ['Capteur T¬∞C', 'Capteur CO2', 'Capteur pr√©sence', 'Gateway', 'Autre'],

  HSE: ['Point de contr√¥le', 'Zone √† risque', 'Autre'],

  // üîß Nouveau LOT GTB
  GTB: [
    'Automate',
    'Interface GTB',
    'Capteurs GTB',
    'Coh√©rence relev√©s GTB / terrain',
    'Autre'
  ]
};


      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // STATE MANAGEMENT
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê


      // === SUPABASE CONFIG (ajout auto) ===
      const SUPABASE_URL = "https://wffxduxwbmluvgrivpoe.supabase.co";
      const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndmZnhkdXh3Ym1sdXZncml2cG9lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5MjMyOTAsImV4cCI6MjA3OTQ5OTI5MH0.YnOTXPh2T0iHSZTjVGi2u45VMcLBxVOGa_a77LX_mR4";
      let supabaseClient = null;
      if (typeof supabase !== 'undefined') {
        try {
          supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        } catch (e) {
          console.error("Erreur initialisation Supabase :", e);
        }
      }
      // === FIN SUPABASE CONFIG ===

      const AppState = {
        currentScreen: 'dashboard',
        currentLot: null,
        currentEquipment: null,
        editingEquipmentId: null,
        currentEV: null,
        currentCRIT: null,
        currentTYPE: null,
        currentBUDGET: null,
        equipmentData: {},
        completedLots: [],
        currentPhotos: [],
        currentCroquis: null,
        googleSheetsUrl: '',
        googleSheetsEnabled: false,
        formatRestitution: 'csv', // NOUVEAU : Format d'export pr√©f√©r√©
        cloudUrl: '', // NOUVEAU : URL plateforme collaborative
        gmaoLogiciel: '', // NOUVEAU : Nom logiciel GMAO
        journalVisite: {
          incidents: '',
          zonesNonVisitees: '',
          pointsARevoir: ''
        },
        syntheseTerrain: {
          forces: '',
          faiblesses: '',
          priorites: '',
          recommandations: ''
        }
      };

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // INITIALISATION
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      document.addEventListener('DOMContentLoaded', function () {
        console.log('üöÄ Initialisation PEC Tech App 100%...');

        loadFromLocalStorage();
        initializeEventListeners();
        renderDashboard();
        updateOnlineStatus();
        startAutoSave();

        console.log('‚úÖ Application initialis√©e');
      });

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // GESTION DES √âCRANS
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function showScreen(screenName) {
        console.log('üì± Navigation vers:', screenName);

        document.querySelectorAll('.screen').forEach((screen) => {
          screen.classList.remove('active');
        });

        const screen = document.getElementById(screenName);
        if (screen) {
          screen.classList.add('active');
          AppState.currentScreen = screenName;
        }
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // RENDER DASHBOARD
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function renderDashboard() {
        console.log('üé® Render Dashboard avec', LOTS_TECHNIQUES.length, 'lots');

        const container = document.getElementById('lotsList');
        if (!container) return;

        container.innerHTML = '';

        LOTS_TECHNIQUES.forEach((lot) => {
          const equipments = AppState.equipmentData[lot] || [];
          const hasEquipments = equipments.length > 0;
          const isCompleted = AppState.completedLots.includes(lot);
          const lotCard = document.createElement('div');
          lotCard.className = `lot-card ${hasEquipments ? 'completed' : ''}`;

          let badgeClass = 'badge-secondary';
          let badgeText = '√Ä faire';
          
          if (isCompleted) {
            badgeClass = 'badge-primary';
            badgeText = '‚úÖ Termin√©';
          } else if (hasEquipments) {
            badgeClass = 'badge-success';
            badgeText = 'üîÑ En cours';
          }

          lotCard.innerHTML = `
            <div class="lot-title">${lot}</div>
            <div class="lot-progress">${equipments.length} √©quipement(s)</div>
            <span class="badge ${badgeClass}">
              ${badgeText}
            </span>
          `;

          lotCard.addEventListener('click', () => selectLot(lot));
          container.appendChild(lotCard);
        });

        updateDashboardStats();
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // MISE √Ä JOUR STATISTIQUES
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function updateDashboardStats() {
        let totalEquipments = 0;
        let totalPhotos = 0;
        let lotsWithData = 0;

        LOTS_TECHNIQUES.forEach((lot) => {
          const equipments = AppState.equipmentData[lot] || [];
          if (equipments.length > 0) lotsWithData++;
          totalEquipments += equipments.length;
          equipments.forEach((eq) => {
            if (eq.photos) totalPhotos += eq.photos.length;
          });
        });

        const lotsCompleted = AppState.completedLots.length;
        const lotsInProgress = lotsWithData - lotsCompleted;
        const progressPercent = Math.round((lotsWithData / LOTS_TECHNIQUES.length) * 100);
        const totalLots = LOTS_TECHNIQUES.length;

        document.getElementById('lotsInProgress').textContent = `${lotsInProgress} / ${totalLots}`;
        document.getElementById('lotsCompleted').textContent = `${lotsCompleted} / ${totalLots}`;
        document.getElementById('equipmentCount').textContent = totalEquipments;
        document.getElementById('photoCount').textContent = totalPhotos;
        document.getElementById('globalProgress').style.width = `${progressPercent}%`;
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // MARQUER LOT COMME TERMIN√â
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function toggleLotCompletion() {
        if (!AppState.currentLot) return;
        
        const lotIndex = AppState.completedLots.indexOf(AppState.currentLot);
        
        if (lotIndex === -1) {
          // Marquer comme termin√©
          AppState.completedLots.push(AppState.currentLot);
          showToast('‚úÖ Lot marqu√© comme termin√©', 'success');
deleteEquipmentFromSupabase(idToDelete)
  .then(()=>console.log("Supabase OK"))
  .catch(e=>console.error(e));
          document.getElementById('btnMarkLotComplete').innerHTML = 'üîÑ Marquer comme en cours';
          document.getElementById('btnMarkLotComplete').classList.remove('btn-primary');
          document.getElementById('btnMarkLotComplete').classList.add('btn-warning');
        } else {
          // Remettre en cours
          AppState.completedLots.splice(lotIndex, 1);
          showToast('üîÑ Lot remis en cours', 'info');
          document.getElementById('btnMarkLotComplete').innerHTML = '‚úÖ Marquer le lot comme termin√©';
          document.getElementById('btnMarkLotComplete').classList.remove('btn-warning');
          document.getElementById('btnMarkLotComplete').classList.add('btn-primary');
        }
        
        saveToLocalStorage();
        renderDashboard();
      }

      function updateLotCompletionButton() {
        const btn = document.getElementById('btnMarkLotComplete');
        if (!btn || !AppState.currentLot) return;
        
        const isCompleted = AppState.completedLots.includes(AppState.currentLot);
        
        if (isCompleted) {
          btn.innerHTML = 'üîÑ Marquer comme en cours';
          btn.classList.remove('btn-primary');
          btn.classList.add('btn-warning');
        } else {
          btn.innerHTML = '‚úÖ Marquer le lot comme termin√©';
          btn.classList.remove('btn-warning');
          btn.classList.add('btn-primary');
        }
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // S√âLECTION LOT
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function selectLot(lotName) {
        console.log('üìÇ Lot s√©lectionn√©:', lotName);
        AppState.currentLot = lotName;

        document.getElementById('currentLotTitle').textContent = lotName;
        document.getElementById('breadcrumbCurrentLot').textContent = lotName;

        renderEquipmentList();
        updateLotCompletionButton();
        showScreen('equipmentList');
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // AFFICHAGE LISTE √âQUIPEMENTS
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function renderEquipmentList() {
        const container = document.getElementById('equipmentGrid');
        const equipments = AppState.equipmentData[AppState.currentLot] || [];

        container.innerHTML = '';

        if (equipments.length === 0) {
          container.innerHTML = `
            <div style="text-align: center; padding: 60px 20px; color: #6c757d;">
              <div style="font-size: 48px; margin-bottom: 20px;">üìã</div>
              <h3>Aucun √©quipement saisi</h3>
              <p>Cliquez sur "Ajouter un √©quipement" pour commencer</p>
            </div>
          `;
          return;
        }

        equipments.forEach((equipment) => {
          const card = document.createElement('div');
          card.className = 'equipment-card';

          const evLabel = ['üî¥ Critique', 'üü† Mauvais', 'üü° Moyen', 'üü¢ Bon', 'üîµ Neuf'][equipment.ev] || '-';

          card.innerHTML = `
            <div class="equipment-info">
              <h3>${equipment.type || '√âquipement'}</h3>
              <div class="equipment-details">
                ${equipment.code || ''} | ${evLabel}
                ${equipment.marque ? ' | ' + equipment.marque : ''}
              </div>
            </div>
            <div style="display: flex; gap: 10px;">
              <button class="btn btn-secondary btn-small" onclick="editEquipment('${equipment.id}')">‚úèÔ∏è Modifier</button>
              <button class="btn btn-danger btn-small" onclick="deleteEquipment('${equipment.id}')">üóëÔ∏è Supprimer</button>
            </div>
          `;

          container.appendChild(card);
        });
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // AFFICHAGE ADAPTATIF 100%
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function applyAdaptiveFormDisplay(lot) {
        console.log('üéØ Affichage adaptatif 100% pour:', lot);

        // Masquer TOUS les champs conditionnels
        const conditionalSections = [
          'mechanical-fields',
          'structural-fields',
          'measurements-section',
          'energy-section',
          'cvc-tests-section',
          'ventilation-section',
          'elec-measures-section',
          'ssi-tests-section',
          'hse-diag-section',
          'iot-data-section',
          'enr-production-section'
        ];

        conditionalSections.forEach((id) => {
          const section = document.getElementById(id);
          if (section) section.classList.add('hidden');
        });

        // Afficher selon le lot (conformit√© 100%)
        switch (lot) {
          case 'CVC Production':
            show(['mechanical-fields', 'measurements-section', 'energy-section', 'cvc-tests-section']);
            break;

          case 'CVC Distribution':
          case 'CVC √âmission':
            show(['mechanical-fields', 'measurements-section', 'energy-section']);
            break;

          case 'Ventilation':
            show(['mechanical-fields', 'measurements-section', 'ventilation-section']);
            break;

          case '√âlectricit√© CFO':
            show(['mechanical-fields', 'elec-measures-section']);
            break;

          case '√âlectricit√© CFA/GTB':
            show(['mechanical-fields']);
            break;

          case 'SSI':
            show(['mechanical-fields', 'ssi-tests-section']);
            break;

          case 'Structure / GO':
          case 'Enveloppe':
          case 'Toitures':
          case 'Plomberie':
            show(['structural-fields']);
            break;

          case 'Ascenseurs':
            show(['mechanical-fields', 'measurements-section']);
            break;

          case 'EnR':
            show(['mechanical-fields', 'measurements-section', 'energy-section', 'enr-production-section']);
            break;

          case 'IoT':
            show(['mechanical-fields', 'iot-data-section']);
            break;

          case 'HSE':
            show(['hse-diag-section']);
            break;

          case 'Locaux techniques':
            show(['structural-fields']);
            break;
        }

        function show(ids) {
          ids.forEach((id) => {
            const section = document.getElementById(id);
            if (section) section.classList.remove('hidden');
          });
        }
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // LISTENERS
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function initializeEventListeners() {
        // Navigation
        document.getElementById('btnExports')?.addEventListener('click', () => showScreen('exports'));
        document.getElementById('btnJournalVisite')?.addEventListener('click', () => {
          loadJournalVisite();
          showScreen('journalVisite');
        });
        document.getElementById('btnSyntheseKpis')?.addEventListener('click', () => {
          loadSyntheseTerrain();
          renderScoreSanteLots();
          renderKPIs();
          showScreen('syntheseKpis');
        });
        document.getElementById('btnRetourLots')?.addEventListener('click', () => {
          showScreen('dashboard');
          renderDashboard();
        });
        document.getElementById('btnRetourEquipments')?.addEventListener('click', () => {
          showScreen('equipmentList');
          renderEquipmentList();
        });

        // Breadcrumbs
        document.getElementById('breadcrumbHome2')?.addEventListener('click', () => {
          showScreen('dashboard');
          renderDashboard();
        });

        // Ajout √©quipement
        document.getElementById('btnAddEquipment')?.addEventListener('click', () => {
          resetForm();
          showScreen('equipmentForm');
        });

        document.getElementById('fabAddEquipment')?.addEventListener('click', () => {
          resetForm();
          showScreen('equipmentForm');
        });

        // Marquer lot termin√©
        document.getElementById('btnMarkLotComplete')?.addEventListener('click', () => {
          toggleLotCompletion();
        });

        // Annuler formulaire
        document.getElementById('btnCancelForm')?.addEventListener('click', () => {
          showScreen('equipmentList');
          renderEquipmentList();
        });

        // Sauvegarder √©quipement
        document.getElementById('btnSaveEquipment')?.addEventListener('click', saveEquipment);

        // Effacer √©quipement
        document.getElementById('btnDeleteEquipment')?.addEventListener('click', deleteEquipment);

        // S√©lections EV, CRIT, TYPE, BUDGET
        document.querySelectorAll('.radio-option').forEach((option) => {
          option.addEventListener('click', function () {
            const parent = this.parentElement;
            parent.querySelectorAll('.radio-option').forEach((opt) => opt.classList.remove('selected'));
            this.classList.add('selected');

            if (this.dataset.ev !== undefined) AppState.currentEV = parseInt(this.dataset.ev);
            if (this.dataset.crit) AppState.currentCRIT = this.dataset.crit;
            if (this.dataset.type) AppState.currentTYPE = this.dataset.type;
            if (this.dataset.budget) AppState.currentBUDGET = this.dataset.budget;

            calculatePriority();
          });
        });

        // Photos
        document.getElementById('formPhotos')?.addEventListener('change', handlePhotoUpload);
        document.getElementById('formPhotoCamera')?.addEventListener('change', handlePhotoUpload);

        // Auto-calculs
        document.getElementById('formTempDepart')?.addEventListener('input', calculateDeltaT);
        document.getElementById('formTempRetour')?.addEventListener('input', calculateDeltaT);
        document.getElementById('formConsommationReel')?.addEventListener('input', calculateEcartPerf);
        document.getElementById('formConsommationTheo')?.addEventListener('input', calculateEcartPerf);
        document.getElementById('formEnRProduction')?.addEventListener('input', calculateEnRPerformance);
        document.getElementById('formEnRPrevisionnel')?.addEventListener('input', calculateEnRPerformance);

        // GPS
        document.getElementById('btnGPS')?.addEventListener('click', captureGPS);

        // Type √©quipement
        document.getElementById('formType')?.addEventListener('change', function () {
          const autreField = document.getElementById('formTypeAutre');
          if (this.value === 'Autre') {
            autreField.style.display = 'block';
          } else {
            autreField.style.display = 'none';
          }
        });

        // NOUVEAU : Format de restitution
        document.getElementById('formatRestitution')?.addEventListener('change', function () {
          const cloudGroup = document.getElementById('cloudUrlGroup');
          const gmaoGroup = document.getElementById('gmaoLogicielGroup');
          
          cloudGroup.style.display = this.value === 'cloud' ? 'block' : 'none';
          gmaoGroup.style.display = this.value === 'gmao' ? 'block' : 'none';
        });
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // RESET FORMULAIRE
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function resetForm() {
        document.getElementById('equipForm')?.reset();
        AppState.editingEquipmentId = null;
        AppState.currentPhotos = [];
        AppState.currentCroquis = null;
        AppState.currentEV = null;
        AppState.currentCRIT = null;
        AppState.currentTYPE = null;
        AppState.currentBUDGET = null;

        document.getElementById('formLot').value = AppState.currentLot || '';
        document.getElementById('formCode').value = generateCode();
        
        // R√©initialiser le canvas
        initCanvas();
        document.getElementById('formDate').valueAsDate = new Date();

        applyAdaptiveFormDisplay(AppState.currentLot);
        populateTypeSelect();

        document.querySelectorAll('.radio-option.selected').forEach((opt) => opt.classList.remove('selected'));
        document.getElementById('photoPreview').innerHTML = '';
        document.getElementById('priorityScore').textContent = '-';
        document.getElementById('priorityLabel').textContent = 'En attente de saisie';
        
        // Cacher le bouton de suppression (nouveau √©quipement)
        document.getElementById('btnDeleteEquipment').style.display = 'none';
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // G√âN√âRATION CODE UNIQUE
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function generateCode() {
        const prefix = AppState.currentLot ? AppState.currentLot.substring(0, 3).toUpperCase() : 'EQP';
        const timestamp = Date.now().toString().slice(-6);
        return `${prefix}-${timestamp}`;
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // POPULATE TYPE SELECT
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function populateTypeSelect() {
        const select = document.getElementById('formType');
        if (!select || !AppState.currentLot) return;

        const types = EQUIPMENT_TYPES_BY_LOT[AppState.currentLot] || [];
        select.innerHTML = '<option value="">S√©lectionner...</option>';
        types.forEach((type) => {
          const option = document.createElement('option');
          option.value = type;
          option.textContent = type;
          select.appendChild(option);
        });
        
        // Toujours ajouter "Autre" √† la fin
        const autreOption = document.createElement('option');
        autreOption.value = 'Autre';
        autreOption.textContent = '‚ûï Autre (saisie libre)';
        select.appendChild(autreOption);
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // TOAST NOTIFICATIONS
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function showToast(message, type = 'info') {
        const container = document.getElementById('toastContainer');
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.textContent = message;
        container.appendChild(toast);

        setTimeout(() => toast.remove(), 3000);
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // CALCUL PRIORIT√â ACTION
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function calculatePriority() {
        const ev = AppState.currentEV;
        const crit = AppState.currentCRIT;
        const budget = AppState.currentBUDGET;

        if (ev === null || !crit || !budget) {
          document.getElementById('priorityScore').textContent = '-';
          document.getElementById('priorityLabel').textContent = 'En attente de saisie';
          return;
        }

        const critWeight = { U: 10, I: 5, A: 2, S: 1 };
        const budgetWeight = { A: 1, B: 2, C: 5, D: 8, E: 10 };

        // Formule : (EV + 1) √ó poids CRIT √ó poids BUDGET
        // EV 0 (Neuf) = priorit√© 1, EV 4 (Critique) = priorit√© 5
        const score = (ev + 1) * critWeight[crit] * budgetWeight[budget];

        document.getElementById('priorityScore').textContent = score;

        let label = '';
        let color = '';

        if (score >= 300) {
          label = 'üî¥ PRIORIT√â ABSOLUE';
          color = '#dc3545';
        } else if (score >= 150) {
          label = 'üü† PRIORIT√â √âLEV√âE';
          color = '#fd7e14';
        } else if (score >= 50) {
          label = 'üü° PRIORIT√â MOYENNE';
          color = '#ffc107';
        } else {
          label = 'üü¢ PRIORIT√â BASSE';
          color = '#28a745';
        }

        document.getElementById('priorityLabel').textContent = label;
        document.getElementById('priorityLabel').style.color = color;
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // CALCULS AUTOMATIQUES
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function calculateDeltaT() {
        const depart = parseFloat(document.getElementById('formTempDepart')?.value);
        const retour = parseFloat(document.getElementById('formTempRetour')?.value);
        if (!isNaN(depart) && !isNaN(retour)) {
          document.getElementById('formDeltaT').value = (depart - retour).toFixed(1);
        }
      }

      function calculateEcartPerf() {
        const reel = parseFloat(document.getElementById('formConsommationReel')?.value);
        const theo = parseFloat(document.getElementById('formConsommationTheo')?.value);
        if (!isNaN(reel) && !isNaN(theo) && theo > 0) {
          const ecart = (((reel - theo) / theo) * 100).toFixed(1);
          document.getElementById('formEcartPerf').value = ecart;
        }
      }

      function calculateEnRPerformance() {
        const prod = parseFloat(document.getElementById('formEnRProduction')?.value);
        const prev = parseFloat(document.getElementById('formEnRPrevisionnel')?.value);
        if (!isNaN(prod) && !isNaN(prev) && prev > 0) {
          const perf = ((prod / prev) * 100).toFixed(1);
          document.getElementById('formEnRPerformance').value = perf;
        }
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // GESTION PHOTOS
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function takePhoto() {
        if (AppState.currentPhotos.length >= 10) {
          showToast('‚ùå Maximum 10 photos par √©quipement', 'error');
          return;
        }
        
        // D√©clencher l'input camera
        const cameraInput = document.getElementById('formPhotoCamera');
        cameraInput.click();
      }

      function handlePhotoUpload(e) {
        const files = Array.from(e.target.files);

        if (AppState.currentPhotos.length + files.length > 10) {
          showToast('‚ùå Maximum 10 photos par √©quipement', 'error');
          return;
        }

        files.forEach((file) => {
          if (file.size > 10 * 1024 * 1024) {
            showToast('‚ùå Photo trop volumineuse : ' + file.name, 'error');
            return;
          }

          const reader = new FileReader();
          reader.onload = function (event) {
            AppState.currentPhotos.push({
              id: Date.now() + Math.random(),
              data: event.target.result,
              name: file.name,
              size: file.size
            });
            renderPhotoPreview();
          };
          reader.readAsDataURL(file);
        });
        
        // R√©initialiser l'input pour permettre de reprendre la m√™me photo
        e.target.value = '';
      }

      function renderPhotoPreview() {
        const container = document.getElementById('photoPreview');
        container.innerHTML = '';

        AppState.currentPhotos.forEach((photo, index) => {
          const div = document.createElement('div');
          div.className = 'photo-item';
          div.innerHTML = `
            <img src="${photo.data}" alt="${photo.name}">
            <button class="photo-remove" onclick="removePhoto(${index})">√ó</button>
          `;
          container.appendChild(div);
        });
      }

      function removePhoto(index) {
        AppState.currentPhotos.splice(index, 1);
        renderPhotoPreview();
      }

      function scanQRCode() {
        showToast('üì∑ Fonction scan QR Code (n√©cessite cam√©ra)', 'info');
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // CANVAS CROQUIS/SCH√âMA
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      let canvas = null;
      let ctx = null;
      let isDrawing = false;
      let currentColor = 'black';
      let lastX = 0;
      let lastY = 0;

      function initCanvas() {
        canvas = document.getElementById('croquisCanvas');
        if (!canvas) return;
        
        ctx = canvas.getContext('2d');
        canvas.width = 600;
        canvas.height = 400;
        
        // Charger le croquis existant si disponible
        if (AppState.currentCroquis) {
          const img = new Image();
          img.onload = function() {
            ctx.drawImage(img, 0, 0);
          };
          img.src = AppState.currentCroquis;
        }
        
        // Events souris
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);
        
        // Events tactiles
        canvas.addEventListener('touchstart', handleTouch);
        canvas.addEventListener('touchmove', handleTouch);
        canvas.addEventListener('touchend', stopDrawing);
      }

      function startDrawing(e) {
        isDrawing = true;
        const rect = canvas.getBoundingClientRect();
        lastX = e.clientX - rect.left;
        lastY = e.clientY - rect.top;
      }

      function draw(e) {
        if (!isDrawing) return;
        
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(x, y);
        ctx.strokeStyle = currentColor;
        ctx.lineWidth = 2;
        ctx.lineCap = 'round';
        ctx.stroke();
        
        lastX = x;
        lastY = y;
      }

      function handleTouch(e) {
        e.preventDefault();
        const touch = e.touches[0];
        const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 'mousemove', {
          clientX: touch.clientX,
          clientY: touch.clientY
        });
        canvas.dispatchEvent(mouseEvent);
      }

      function stopDrawing() {
        if (isDrawing) {
          isDrawing = false;
          // Sauvegarder le croquis
          AppState.currentCroquis = canvas.toDataURL();
        }
      }

      function clearCanvas() {
        if (ctx) {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          AppState.currentCroquis = null;
        }
      }

      function changeDrawColor(color) {
        currentColor = color;
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // GPS
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function captureGPS() {
        if ('geolocation' in navigator) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const info = `üìç ${position.coords.latitude.toFixed(6)}, ${position.coords.longitude.toFixed(6)}`;
              document.getElementById('gpsInfo').textContent = info;
              showToast('‚úÖ Position GPS captur√©e', 'success');
            },
            (error) => {
              showToast('‚ùå Impossible de capturer le GPS', 'error');
            }
          );
        } else {
          showToast('‚ùå GPS non disponible', 'error');
        }
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // GOOGLE SHEETS INTEGRATION
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      async function sendToGoogleSheets(equipment) {
        try {
          const response = await fetch(AppState.googleSheetsUrl, {
            method: 'POST',
            mode: 'no-cors',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(equipment)
          });
          
          console.log('üìä Donn√©es envoy√©es vers Google Sheets');
          showToast('üìä Synchronis√© avec Google Sheets', 'success');
        } catch (error) {
          console.error('‚ùå Erreur Google Sheets:', error);
          showToast('‚ö†Ô∏è Erreur de synchronisation Google Sheets', 'warning');
        }
      }

      function configureGoogleSheets() {
        const url = prompt(
          'üîó CONFIGURATION GOOGLE SHEETS\n\n' +
          'Collez l\'URL de votre Web App Google Apps Script:\n' +
          '(Format: https://script.google.com/macros/s/.../exec)',
          AppState.googleSheetsUrl || ''
        );
        
        if (url) {
          AppState.googleSheetsUrl = url.trim();
          AppState.googleSheetsEnabled = true;
          localStorage.setItem('pecTechGoogleSheetsUrl', url.trim());
          localStorage.setItem('pecTechGoogleSheetsEnabled', 'true');
          showToast('‚úÖ Google Sheets configur√© et activ√©', 'success');
        }
      }

      function toggleGoogleSheets() {
        if (!AppState.googleSheetsUrl) {
          showToast('‚ö†Ô∏è Veuillez d\'abord configurer l\'URL Google Sheets', 'warning');
          configureGoogleSheets();
          return;
        }
        
        AppState.googleSheetsEnabled = !AppState.googleSheetsEnabled;
        localStorage.setItem('pecTechGoogleSheetsEnabled', AppState.googleSheetsEnabled);
        
        const status = AppState.googleSheetsEnabled ? 'activ√©e' : 'd√©sactiv√©e';
        const icon = AppState.googleSheetsEnabled ? '‚úÖ' : '‚è∏Ô∏è';
        showToast(`${icon} Synchronisation Google Sheets ${status}`, 'info');
        
        updateGoogleSheetsButton();
      }

      function updateGoogleSheetsButton() {
        const btn = document.getElementById('btnToggleGoogleSheets');
        if (btn) {
          if (AppState.googleSheetsEnabled) {
            btn.textContent = '‚úÖ Google Sheets Activ√©';
            btn.style.backgroundColor = '#28a745';
          } else {
            btn.textContent = '‚è∏Ô∏è Google Sheets D√©sactiv√©';
            btn.style.backgroundColor = '#6c757d';
          }
        }
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // SAUVEGARDE √âQUIPEMENT
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function saveEquipment() {
        if (!AppState.currentLot) {
          showToast('‚ùå Erreur: aucun lot s√©lectionn√©', 'error');
          return;
        }

        const equipment = {
          id: AppState.editingEquipmentId || Date.now().toString(),
          lot: AppState.currentLot,
          date: document.getElementById('formDate').value,
          heureDebut: document.getElementById('formHeureDebut').value,
          heureFin: document.getElementById('formHeureFin').value,
          technicien: document.getElementById('formTechnicien').value,
          entreprise: document.getElementById('formEntreprise').value,
          contactSite: document.getElementById('formContactSite').value,
          telReferent: document.getElementById('formTelReferent').value,
          meteo: document.getElementById('formMeteo').value,
          typeVisite: document.getElementById('formTypeVisite').value,
          niveau: document.getElementById('formNiveau').value,
          local: document.getElementById('formLocal').value,
          type: document.getElementById('formType').value === 'Autre' ? document.getElementById('formTypeAutre').value : document.getElementById('formType').value,
          code: document.getElementById('formCode').value,
          qrCode: document.getElementById('formQRCode').value,
          refDOE: document.getElementById('formRefDOE').value,
          refPlan: document.getElementById('formRefPlan').value,
          marque: document.getElementById('formMarque')?.value,
          modele: document.getElementById('formModele')?.value,
          serie: document.getElementById('formSerie')?.value,
          puissance: document.getElementById('formPuissance')?.value,
          unite: document.getElementById('formUnite')?.value,
          annee: document.getElementById('formAnnee')?.value,
          ev: AppState.currentEV,
          crit: AppState.currentCRIT,
          type_anomalie: AppState.currentTYPE,
          budget: AppState.currentBUDGET,
          priorite: document.getElementById('priorityScore').textContent,
          constat: document.getElementById('formConstat').value,
          observations: document.getElementById('formObservations').value,
          actions: document.getElementById('formActions').value,
          photos: AppState.currentPhotos,
          croquis: AppState.currentCroquis,
          timestamp: new Date().toISOString()
        };

        if (!AppState.equipmentData[AppState.currentLot]) {
          AppState.equipmentData[AppState.currentLot] = [];
        }

        if (AppState.editingEquipmentId) {
          const index = AppState.equipmentData[AppState.currentLot].findIndex((e) => e.id === AppState.editingEquipmentId);
          if (index !== -1) {
            AppState.equipmentData[AppState.currentLot][index] = equipment;
          }
        } else {
          AppState.equipmentData[AppState.currentLot].push(equipment);
        }

        saveToLocalStorage();
        showToast('‚úÖ √âquipement enregistr√© avec succ√®s', 'success');

        // Envoyer vers Google Sheets si activ√©
        if (AppState.googleSheetsEnabled && AppState.googleSheetsUrl) {
          sendToGoogleSheets(equipment);
        }


        // Envoi vers Supabase (si disponible)
        if (typeof supabaseClient !== 'undefined' && supabaseClient) {
          sendToSupabase(equipment);
        }

        setTimeout(() => {
          showScreen('equipmentList');
          renderEquipmentList();
        }, 1000);
      }

      
      // Envoi d'un √©quipement vers Supabase (lignes + photos)
      async function sendToSupabase(equipment) {
        try {
          if (!supabaseClient) {
            console.warn("Supabase non initialis√© (supabaseClient nul).");
            return;
          }

          // Payload strictement align√© sur les colonnes de la table "equipements"
          const payload = {
            code: equipment.code || null,
            lot: equipment.lot || null,
            niveau: equipment.niveau || null,
            local: equipment.local || null,
            date_visite: equipment.date || null,
            heure_debut: equipment.heureDebut || null,
            heure_fin: equipment.heureFin || null,
            technicien: equipment.technicien || null,
            entreprise: equipment.entreprise || null,
            ev: typeof equipment.ev === "number" ? equipment.ev : (equipment.ev ? Number(equipment.ev) || null : null),
            criticite: equipment.crit || null,
            type_anomalie: equipment.type_anomalie || null,
            budget: equipment.budget || null,
            remarques: equipment.observations || equipment.constat || null,
            latitude: typeof equipment.latitude === "number" ? equipment.latitude : (equipment.latitude ? Number(equipment.latitude) || null : null),
            longitude: typeof equipment.longitude === "number" ? equipment.longitude : (equipment.longitude ? Number(equipment.longitude) || null : null),
            // On garde une version JSON all√©g√©e de l'√©quipement SANS les grosses donn√©es (photos, croquis)
            data: (function () {
              const clone = { ...equipment };
              delete clone.photos;
              delete clone.croquis;
              return clone;
            })()
          };

          console.log("Payload envoy√© √† Supabase :", payload);

          // Insertion de la ligne d'√©quipement + r√©cup√©ration de l'id
          const { data: inserted, error } = await supabaseClient
            .from("equipements")
            .insert(payload)
            .select()
            .single();

          if (error) {
            console.error("Erreur insertion Supabase :", error);
            showToast('‚ùå Erreur lors de l\'envoi vers Supabase', 'error');
            return;
          }

          console.log("√âquipement ins√©r√© dans Supabase :", inserted);

          // Upload des photos dans le bucket + table photos (si pr√©sentes)
          if (Array.isArray(equipment.photos) && equipment.photos.length > 0) {
            for (let i = 0; i < equipment.photos.length; i++) {
              const photoItem = equipment.photos[i];
              const base64 = (typeof photoItem === "string") ? photoItem : (photoItem && photoItem.data ? photoItem.data : null);
              if (!base64) continue;

              const url = await uploadPhotoToSupabase(base64, `photo_${i + 1}.jpg`, inserted.id);
              if (!url) continue;

              const { error: photoErr } = await supabaseClient
                .from("photos")
                .insert({
                  equipement_id: inserted.id,
                  url: url
                });

              if (photoErr) {
                console.error("Erreur insertion ligne photo Supabase :", photoErr);
              }
            }
          }

          showToast('‚úÖ √âquipement envoy√© √† Supabase', 'success');
        } catch (e) {
          console.error("Erreur sendToSupabase (exception) :", e);
          showToast('‚ùå Erreur technique Supabase', 'error');
        }
      }

      // Upload d'une photo base64 vers le bucket "pec-photos"
      async function uploadPhotoToSupabase(base64Data, fileName, equipmentId) {
        try {
          if (!supabaseClient || !supabaseClient.storage) {
            console.warn("Supabase storage non disponible.");
            return null;
          }

          if (typeof base64Data !== "string") {
            console.warn("uploadPhotoToSupabase: base64Data n'est pas une cha√Æne", base64Data);
            return null;
          }

          const parts = base64Data.split(';base64,');
          if (parts.length !== 2) {
            console.warn("Format base64 inattendu pour la photo.");
            return null;
          }

          const contentType = parts[0].replace('data:', '');
          const byteCharacters = atob(parts[1]);
          const byteArrays = [];

          for (let offset = 0; offset < byteCharacters.length; offset += 512) {
            const slice = byteCharacters.slice(offset, offset + 512);
            const byteNumbers = new Array(slice.length);
            for (let i = 0; i < slice.length; i++) {
              byteNumbers[i] = slice.charCodeAt(i);
            }
            byteArrays.push(new Uint8Array(byteNumbers));
          }

          const file = new Blob(byteArrays, { type: contentType || "image/jpeg" });

          const path = `${equipmentId}/${fileName}`;
          const { error } = await supabaseClient
            .storage
            .from("pec-photos")
            .upload(path, file, {
              cacheControl: "3600",
              upsert: true
            });

          if (error) {
            console.error("Erreur upload photo Supabase :", error);
            return null;
          }

          // URL publique (bucket "public")
          const publicUrl = `${SUPABASE_URL}/storage/v1/object/public/pec-photos/${equipmentId}/${fileName}`;
          return publicUrl;
        } catch (err) {
          console.error("Exception uploadPhotoToSupabase :", err);
          return null;
        }
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // SUPPRESSION √âQUIPEMENT


      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function deleteEquipment(equipmentId = null) {
        // Si appel√© depuis le formulaire (mode √©dition)
        const idToDelete = equipmentId || AppState.editingEquipmentId;
        
        if (!AppState.currentLot || !idToDelete) {
          showToast('‚ùå Erreur: aucun √©quipement s√©lectionn√©', 'error');
          return;
        }

        // Demander confirmation
        const equipmentToDelete = AppState.equipmentData[AppState.currentLot]?.find(
          (e) => e.id === idToDelete
        );
        
        if (!equipmentToDelete) {
          showToast('‚ùå Erreur: √©quipement introuvable', 'error');
          return;
        }
        
        const equipmentName = equipmentToDelete.type || '√âquipement';
        const confirmMessage = `‚ö†Ô∏è ATTENTION : Voulez-vous vraiment SUPPRIMER d√©finitivement cette fiche ?\n\n` +
                              `Lot: ${AppState.currentLot}\n` +
                              `√âquipement: ${equipmentName}\n` +
                              `Code: ${equipmentToDelete.code || 'N/A'}\n\n` +
                              `Cette action est IRR√âVERSIBLE !`;

        if (!confirm(confirmMessage)) {
          return;
        }

        // Supprimer l'√©quipement
        const index = AppState.equipmentData[AppState.currentLot].findIndex(
          (e) => e.id === idToDelete
        );

        if (index !== -1) {
          AppState.equipmentData[AppState.currentLot].splice(index, 1);
          saveToLocalStorage();
          showToast('üóëÔ∏è Fiche supprim√©e avec succ√®s', 'success');

          // Si appel√© depuis le formulaire, retourner √† la liste
          if (!equipmentId) {
            setTimeout(() => {
              showScreen('equipmentList');
              renderEquipmentList();
            }, 1000);
          } else {
            // Si appel√© depuis la liste, juste rafra√Æchir la liste
            renderEquipmentList();
          }
        } else {
          showToast('‚ùå Erreur: √©quipement introuvable', 'error');
        }
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // √âDITION √âQUIPEMENT
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function editEquipment(id) {
        // Trouver l'√©quipement
        const equipment = AppState.equipmentData[AppState.currentLot]?.find((e) => e.id === id);
        
        if (!equipment) {
          showToast('‚ùå √âquipement introuvable', 'error');
          return;
        }

        // Passer en mode √©dition
        AppState.editingEquipmentId = id;
        
        // Appliquer l'affichage adaptatif pour le lot
        applyAdaptiveFormDisplay(AppState.currentLot);
        populateTypeSelect();
        
        // Remplir le formulaire avec les donn√©es existantes
        document.getElementById('formLot').value = equipment.lot || '';
        document.getElementById('formDate').value = equipment.date || '';
        document.getElementById('formHeureDebut').value = equipment.heureDebut || '';
        document.getElementById('formHeureFin').value = equipment.heureFin || '';
        document.getElementById('formTechnicien').value = equipment.technicien || '';
        document.getElementById('formEntreprise').value = equipment.entreprise || '';
        document.getElementById('formContactSite').value = equipment.contactSite || '';
        document.getElementById('formTelReferent').value = equipment.telReferent || '';
        document.getElementById('formMeteo').value = equipment.meteo || '';
        document.getElementById('formTypeVisite').value = equipment.typeVisite || '';
        document.getElementById('formNiveau').value = equipment.niveau || '';
        document.getElementById('formLocal').value = equipment.local || '';
        
        // G√©rer le type d'√©quipement (y compris "Autre")
        const typeSelect = document.getElementById('formType');
        const typeAutreField = document.getElementById('formTypeAutre');
        const equipmentType = equipment.type || '';
        
        // V√©rifier si le type existe dans les options du select
        let typeExists = false;
        for (let option of typeSelect.options) {
          if (option.value === equipmentType) {
            typeExists = true;
            break;
          }
        }
        
        if (typeExists) {
          // Type standard trouv√© dans la liste
          typeSelect.value = equipmentType;
          typeAutreField.style.display = 'none';
          typeAutreField.value = '';
        } else if (equipmentType) {
          // Type personnalis√© : s√©lectionner "Autre" et remplir le champ texte
          typeSelect.value = 'Autre';
          typeAutreField.style.display = 'block';
          typeAutreField.value = equipmentType;
        } else {
          // Pas de type d√©fini
          typeSelect.value = '';
          typeAutreField.style.display = 'none';
          typeAutreField.value = '';
        }
        
        document.getElementById('formCode').value = equipment.code || '';
        document.getElementById('formQRCode').value = equipment.qrCode || '';
        document.getElementById('formRefDOE').value = equipment.refDOE || '';
        document.getElementById('formRefPlan').value = equipment.refPlan || '';
        
        // Champs m√©caniques
        if (document.getElementById('formMarque')) document.getElementById('formMarque').value = equipment.marque || '';
        if (document.getElementById('formModele')) document.getElementById('formModele').value = equipment.modele || '';
        if (document.getElementById('formSerie')) document.getElementById('formSerie').value = equipment.serie || '';
        if (document.getElementById('formPuissance')) document.getElementById('formPuissance').value = equipment.puissance || '';
        if (document.getElementById('formUnite')) document.getElementById('formUnite').value = equipment.unite || '';
        if (document.getElementById('formAnnee')) document.getElementById('formAnnee').value = equipment.annee || '';
        
        // √âtat et crit√®res
        AppState.currentEV = equipment.ev;
        AppState.currentCRIT = equipment.crit;
        AppState.currentTYPE = equipment.type_anomalie;
        AppState.currentBUDGET = equipment.budget;
        
        // Observations
        document.getElementById('formConstat').value = equipment.constat || '';
        document.getElementById('formObservations').value = equipment.observations || '';
        document.getElementById('formActions').value = equipment.actions || '';
        
        // Photos
        AppState.currentPhotos = equipment.photos || [];
        
        // Croquis
        AppState.currentCroquis = equipment.croquis || null;
        initCanvas();
        
        // Afficher les s√©lections visuelles
        document.querySelectorAll('.radio-option').forEach((opt) => {
          opt.classList.remove('selected');
          if (opt.dataset.ev !== undefined && parseInt(opt.dataset.ev) === equipment.ev) {
            opt.classList.add('selected');
          }
          if (opt.dataset.crit && opt.dataset.crit === equipment.crit) {
            opt.classList.add('selected');
          }
          if (opt.dataset.type && opt.dataset.type === equipment.type_anomalie) {
            opt.classList.add('selected');
          }
          if (opt.dataset.budget && opt.dataset.budget === equipment.budget) {
            opt.classList.add('selected');
          }
        });
        
        // Afficher les photos
        renderPhotoPreview();
        
        // Recalculer la priorit√©
        calculatePriority();
        
        // AFFICHER le bouton de suppression (mode √©dition)
        document.getElementById('btnDeleteEquipment').style.display = 'inline-block';
        
        // Afficher le formulaire
        showScreen('equipmentForm');
        
        showToast('‚úèÔ∏è Mode √©dition activ√©', 'info');
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // STATUT ONLINE/OFFLINE
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function updateOnlineStatus() {
        const status = document.getElementById('onlineStatus');
        const banner = document.getElementById('offlineBanner');

        if (navigator.onLine) {
          status.textContent = 'üü¢';
          banner.style.display = 'none';
        } else {
          status.textContent = 'üî¥';
          banner.style.display = 'block';
        }
      }

      window.addEventListener('online', updateOnlineStatus);
      window.addEventListener('offline', updateOnlineStatus);

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // LOCALSTORAGE
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function loadFromLocalStorage() {
        try {
          const saved = localStorage.getItem('pecTechData');
          if (saved) {
            AppState.equipmentData = JSON.parse(saved);
            console.log('‚úÖ Donn√©es charg√©es:', Object.keys(AppState.equipmentData).length, 'lots');
          }
          
          const savedCompletedLots = localStorage.getItem('pecTechCompletedLots');
          if (savedCompletedLots) {
            AppState.completedLots = JSON.parse(savedCompletedLots);
            console.log('‚úÖ Lots termin√©s charg√©s:', AppState.completedLots.length);
          }
          
          // Charger la configuration Google Sheets
          const savedGoogleSheetsUrl = localStorage.getItem('pecTechGoogleSheetsUrl');
          if (savedGoogleSheetsUrl) {
            AppState.googleSheetsUrl = savedGoogleSheetsUrl;
            console.log('‚úÖ URL Google Sheets charg√©e');
          }
          
          const savedGoogleSheetsEnabled = localStorage.getItem('pecTechGoogleSheetsEnabled');
          if (savedGoogleSheetsEnabled) {
            AppState.googleSheetsEnabled = savedGoogleSheetsEnabled === 'true';
            console.log('‚úÖ √âtat Google Sheets:', AppState.googleSheetsEnabled ? 'Activ√©' : 'D√©sactiv√©');
          }
          
          // NOUVEAU : Charger format de restitution
          const savedFormatRestitution = localStorage.getItem('pecTechFormatRestitution');
          if (savedFormatRestitution) {
            AppState.formatRestitution = savedFormatRestitution;
            console.log('‚úÖ Format restitution charg√©:', savedFormatRestitution);
          }
          
          const savedCloudUrl = localStorage.getItem('pecTechCloudUrl');
          if (savedCloudUrl) {
            AppState.cloudUrl = savedCloudUrl;
          }
          
          const savedGmaoLogiciel = localStorage.getItem('pecTechGmaoLogiciel');
          if (savedGmaoLogiciel) {
            AppState.gmaoLogiciel = savedGmaoLogiciel;
          }
          
          // Mettre √† jour le bouton et charger les pr√©f√©rences
          updateGoogleSheetsButton();
          loadFormatRestitutionPreferences();
        } catch (e) {
          console.error('‚ùå Erreur chargement donn√©es:', e);
        }
      }

      function saveToLocalStorage() {
        try {
          localStorage.setItem('pecTechData', JSON.stringify(AppState.equipmentData));
          localStorage.setItem('pecTechCompletedLots', JSON.stringify(AppState.completedLots));
          console.log('üíæ Donn√©es sauvegard√©es');
        } catch (e) {
          console.error('‚ùå Erreur sauvegarde:', e);
        }
      }

      function startAutoSave() {
        setInterval(() => {
          saveToLocalStorage();
        }, 30000);
      }

      function clearAllData() {
        if (confirm('‚ö†Ô∏è ATTENTION : Cette action va supprimer TOUTES les donn√©es. Continuer ?')) {
          AppState.equipmentData = {};
          AppState.completedLots = [];
          AppState.journalVisite = { incidents: '', zonesNonVisitees: '', pointsARevoir: '' };
          AppState.syntheseTerrain = { forces: '', faiblesses: '', priorites: '', recommandations: '' };
          localStorage.removeItem('pecTechData');
          localStorage.removeItem('pecTechCompletedLots');
          localStorage.removeItem('pecTechJournal');
          localStorage.removeItem('pecTechSynthese');
          showToast('üóëÔ∏è Toutes les donn√©es ont √©t√© effac√©es', 'warning');
          renderDashboard();
        }
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // JOURNAL DE VISITE
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function loadJournalVisite() {
        const saved = localStorage.getItem('pecTechJournal');
        if (saved) {
          AppState.journalVisite = JSON.parse(saved);
        }
        document.getElementById('journalIncidents').value = AppState.journalVisite.incidents || '';
        document.getElementById('journalZonesNonVisitees').value = AppState.journalVisite.zonesNonVisitees || '';
        document.getElementById('journalPointsARevoir').value = AppState.journalVisite.pointsARevoir || '';
      }

      function saveJournalVisite() {
        AppState.journalVisite = {
          incidents: document.getElementById('journalIncidents').value,
          zonesNonVisitees: document.getElementById('journalZonesNonVisitees').value,
          pointsARevoir: document.getElementById('journalPointsARevoir').value
        };
        localStorage.setItem('pecTechJournal', JSON.stringify(AppState.journalVisite));
        showToast('‚úÖ Journal de visite sauvegard√©', 'success');
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // SYNTH√àSE TERRAIN
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function loadSyntheseTerrain() {
        const saved = localStorage.getItem('pecTechSynthese');
        if (saved) {
          AppState.syntheseTerrain = JSON.parse(saved);
        }
        document.getElementById('syntheseForces').value = AppState.syntheseTerrain.forces || '';
        document.getElementById('syntheseFaiblesses').value = AppState.syntheseTerrain.faiblesses || '';
        document.getElementById('synthesePriorites').value = AppState.syntheseTerrain.priorites || '';
        document.getElementById('syntheseRecommandations').value = AppState.syntheseTerrain.recommandations || '';
      }

      function saveSyntheseTerrain() {
        AppState.syntheseTerrain = {
          forces: document.getElementById('syntheseForces').value,
          faiblesses: document.getElementById('syntheseFaiblesses').value,
          priorites: document.getElementById('synthesePriorites').value,
          recommandations: document.getElementById('syntheseRecommandations').value
        };
        localStorage.setItem('pecTechSynthese', JSON.stringify(AppState.syntheseTerrain));
        showToast('‚úÖ Synth√®se terrain sauvegard√©e', 'success');
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // SCORE DE SANT√â GLOBAL PAR LOT
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function renderScoreSanteLots() {
        const container = document.getElementById('scoresSanteLots');
        
        let html = `
          <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
            <thead>
              <tr style="background: #2c5aa0; color: white;">
                <th style="padding: 12px; text-align: left;">Lot Technique</th>
                <th style="padding: 12px; text-align: center;">Nb √âquipements</th>
                <th style="padding: 12px; text-align: center;">Score Moyen EV</th>
                <th style="padding: 12px; text-align: center;">Interpr√©tation</th>
              </tr>
            </thead>
            <tbody>
        `;
        
        let totalScore = 0;
        let totalEquipments = 0;
        
        LOTS_TECHNIQUES.forEach(lot => {
          const equipments = AppState.equipmentData[lot] || [];
          const nbEquipments = equipments.length;
          
          if (nbEquipments > 0) {
            const sumEV = equipments.reduce((sum, eq) => sum + (eq.ev !== undefined ? eq.ev : 0), 0);
            const avgEV = (sumEV / nbEquipments).toFixed(1);
            totalScore += parseFloat(avgEV) * nbEquipments;
            totalEquipments += nbEquipments;
            
            let interpretation = '';
            let color = '';
            if (avgEV <= 1) {
              interpretation = 'üü¢ Excellent';
              color = '#28a745';
            } else if (avgEV <= 2) {
              interpretation = 'üü° Bon';
              color = '#ffc107';
            } else if (avgEV <= 3) {
              interpretation = 'üü† Moyen';
              color = '#fd7e14';
            } else {
              interpretation = 'üî¥ Critique';
              color = '#dc3545';
            }
            
            html += `
              <tr style="border-bottom: 1px solid #dee2e6;">
                <td style="padding: 12px;">${lot}</td>
                <td style="padding: 12px; text-align: center;">${nbEquipments}</td>
                <td style="padding: 12px; text-align: center; font-weight: bold;">${avgEV}</td>
                <td style="padding: 12px; text-align: center; color: ${color}; font-weight: bold;">${interpretation}</td>
              </tr>
            `;
          }
        });
        
        const globalScore = totalEquipments > 0 ? (totalScore / totalEquipments).toFixed(1) : '-';
        let globalInterpretation = '';
        let globalColor = '';
        
        if (globalScore !== '-') {
          if (globalScore <= 1) {
            globalInterpretation = 'üü¢ Excellent';
            globalColor = '#28a745';
          } else if (globalScore <= 2) {
            globalInterpretation = 'üü° Bon';
            globalColor = '#ffc107';
          } else if (globalScore <= 3) {
            globalInterpretation = 'üü† Moyen';
            globalColor = '#fd7e14';
          } else {
            globalInterpretation = 'üî¥ Critique';
            globalColor = '#dc3545';
          }
        }
        
        html += `
              <tr style="background: #f8f9fa; font-weight: bold; font-size: 1.1em;">
                <td style="padding: 15px;">SCORE GLOBAL B√ÇTIMENT</td>
                <td style="padding: 15px; text-align: center;">${totalEquipments}</td>
                <td style="padding: 15px; text-align: center;">${globalScore}</td>
                <td style="padding: 15px; text-align: center; color: ${globalColor};">${globalInterpretation}</td>
              </tr>
            </tbody>
          </table>
        `;
        
        container.innerHTML = html;
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // INDICATEURS DE PERFORMANCE (KPIs)
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function renderKPIs() {
        const container = document.getElementById('kpisContainer');
        
        // Calculer les KPIs
        let totalEquipments = 0;
        let totalPhotos = 0;
        let anomaliesU = 0, anomaliesI = 0, anomaliesA = 0, anomaliesS = 0;
        let budgetTotal = 0;
        
        LOTS_TECHNIQUES.forEach(lot => {
          const equipments = AppState.equipmentData[lot] || [];
          totalEquipments += equipments.length;
          
          equipments.forEach(eq => {
            if (eq.photos) totalPhotos += eq.photos.length;
            
            // Compter les anomalies par criticit√©
            if (eq.crit === 'U') anomaliesU++;
            else if (eq.crit === 'I') anomaliesI++;
            else if (eq.crit === 'A') anomaliesA++;
            else if (eq.crit === 'S') anomaliesS++;
            
            // Estimer le budget (centre de fourchette)
            if (eq.budget === 'A') budgetTotal += 250;
            else if (eq.budget === 'B') budgetTotal += 1250;
            else if (eq.budget === 'C') budgetTotal += 6000;
            else if (eq.budget === 'D') budgetTotal += 30000;
            else if (eq.budget === 'E') budgetTotal += 75000;
          });
        });
        
        const lotsWithData = Object.keys(AppState.equipmentData).filter(lot => AppState.equipmentData[lot].length > 0).length;
        const couverture = Math.round((lotsWithData / LOTS_TECHNIQUES.length) * 100);
        
        let html = `
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0;">
            
            <div style="background: white; border: 2px solid #dee2e6; border-radius: 8px; padding: 20px; text-align: center;">
              <h3 style="color: #2c5aa0; margin-bottom: 10px;">üìä Couverture</h3>
              <div style="font-size: 36px; font-weight: bold; color: #28a745;">${couverture}%</div>
              <p style="color: #6c757d; margin-top: 10px;">${lotsWithData} / ${LOTS_TECHNIQUES.length} lots audit√©s</p>
            </div>
            
            <div style="background: white; border: 2px solid #dee2e6; border-radius: 8px; padding: 20px; text-align: center;">
              <h3 style="color: #2c5aa0; margin-bottom: 10px;">üîß √âquipements</h3>
              <div style="font-size: 36px; font-weight: bold; color: #007bff;">${totalEquipments}</div>
              <p style="color: #6c757d; margin-top: 10px;">fiches cr√©√©es</p>
            </div>
            
            <div style="background: white; border: 2px solid #dee2e6; border-radius: 8px; padding: 20px; text-align: center;">
              <h3 style="color: #2c5aa0; margin-bottom: 10px;">üì∏ Photos</h3>
              <div style="font-size: 36px; font-weight: bold; color: #6c757d;">${totalPhotos}</div>
              <p style="color: #6c757d; margin-top: 10px;">prises terrain</p>
            </div>
            
            <div style="background: white; border: 2px solid #dee2e6; border-radius: 8px; padding: 20px; text-align: center;">
              <h3 style="color: #2c5aa0; margin-bottom: 10px;">üí∞ Budget Estim√©</h3>
              <div style="font-size: 28px; font-weight: bold; color: #dc3545;">${Math.round(budgetTotal).toLocaleString()}‚Ç¨</div>
              <p style="color: #6c757d; margin-top: 10px;">Interventions totales</p>
            </div>
            
          </div>
          
          <h3 style="color: #333; margin: 30px 0 15px 0;">‚ö†Ô∏è Anomalies par Criticit√©</h3>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
            <div style="background: #dc3545; color: white; padding: 15px; border-radius: 8px; text-align: center;">
              <div style="font-size: 32px; font-weight: bold;">${anomaliesU}</div>
              <div>üî¥ URGENT</div>
            </div>
            <div style="background: #fd7e14; color: white; padding: 15px; border-radius: 8px; text-align: center;">
              <div style="font-size: 32px; font-weight: bold;">${anomaliesI}</div>
              <div>üü† IMPORTANT</div>
            </div>
            <div style="background: #ffc107; color: #212529; padding: 15px; border-radius: 8px; text-align: center;">
              <div style="font-size: 32px; font-weight: bold;">${anomaliesA}</div>
              <div>üü° AM√âLIORATION</div>
            </div>
            <div style="background: #28a745; color: white; padding: 15px; border-radius: 8px; text-align: center;">
              <div style="font-size: 32px; font-weight: bold;">${anomaliesS}</div>
              <div>üü¢ SUIVI</div>
            </div>
          </div>
        `;
        
        container.innerHTML = html;
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // EXPORTS FONCTIONNELS
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function exportCSVAndPhotos() {
        showToast('üìÑ G√©n√©ration CSV + Photos en cours...', 'info');
        
        // G√©n√©rer CSV
        const csvContent = generateCSV();
        downloadFile(csvContent, `PEC_LaDefense_releves_${getTodayDateString()}.csv`, 'text/csv');
        
        // G√©n√©rer ZIP de photos
        setTimeout(() => {
          generatePhotoZIP();
        }, 500);
      }

      function generateCSV() {
        // En-t√™tes CSV
        const headers = [
          'Lot',
          'Type',
          'Code',
          'QR Code',
          'Ref DOE',
          'Ref Plan',
          'Date',
          'Technicien',
          'Niveau',
          'Local',
          'Marque',
          'Mod√®le',
          'S√©rie',
          'Puissance',
          'Unit√©',
          'Ann√©e',
          'EV',
          'CRIT',
          'Type Anomalie',
          'Budget',
          'Priorit√©',
          'Constat',
          'Observations',
          'Actions',
          'Photos',
          'Timestamp'
        ];

        let csv = headers.join(';') + '\n';

        // Parcourir tous les lots
        LOTS_TECHNIQUES.forEach(lot => {
          const equipments = AppState.equipmentData[lot] || [];
          equipments.forEach(eq => {
            const evLabels = ['Critique', 'Mauvais', 'Moyen', 'Bon', 'Neuf'];
            const photoNames = (eq.photos || []).map(p => p.name).join(', ');
            
            const row = [
              escapeCSV(lot),
              escapeCSV(eq.type || ''),
              escapeCSV(eq.code || ''),
              escapeCSV(eq.qrCode || ''),
              escapeCSV(eq.refDOE || ''),
              escapeCSV(eq.refPlan || ''),
              escapeCSV(eq.date || ''),
              escapeCSV(eq.technicien || ''),
              escapeCSV(eq.niveau || ''),
              escapeCSV(eq.local || ''),
              escapeCSV(eq.marque || ''),
              escapeCSV(eq.modele || ''),
              escapeCSV(eq.serie || ''),
              escapeCSV(eq.puissance || ''),
              escapeCSV(eq.unite || ''),
              escapeCSV(eq.annee || ''),
              eq.ev !== null ? evLabels[eq.ev] : '',
              escapeCSV(eq.crit || ''),
              escapeCSV(eq.type_anomalie || ''),
              escapeCSV(eq.budget || ''),
              escapeCSV(eq.priorite || ''),
              escapeCSV(eq.constat || ''),
              escapeCSV(eq.observations || ''),
              escapeCSV(eq.actions || ''),
              escapeCSV(photoNames),
              escapeCSV(eq.timestamp || '')
            ];
            
            csv += row.join(';') + '\n';
          });
        });

        return csv;
      }

      function escapeCSV(str) {
        if (str === null || str === undefined) return '';
        str = String(str);
        if (str.includes(';') || str.includes('"') || str.includes('\n')) {
          return '"' + str.replace(/"/g, '""') + '"';
        }
        return str;
      }

      function generatePhotoZIP() {
        showToast('üì¶ Pr√©paration du ZIP des photos...', 'info');
        
        // Cr√©er un objet texte simulant un ZIP (limitation navigateur)
        // En r√©alit√©, on va cr√©er un fichier texte listant les photos
        let photoList = '=== PHOTOS PEC LA D√âFENSE ===\n\n';
        let totalPhotos = 0;
        
        LOTS_TECHNIQUES.forEach(lot => {
          const equipments = AppState.equipmentData[lot] || [];
          if (equipments.length > 0) {
            photoList += `\nüìÅ LOT: ${lot}\n`;
            photoList += '‚îÄ'.repeat(50) + '\n';
            
            equipments.forEach(eq => {
              if (eq.photos && eq.photos.length > 0) {
                photoList += `\n  √âquipement: ${eq.type} (${eq.code})\n`;
                eq.photos.forEach((photo, index) => {
                  photoList += `    üì∑ ${eq.code}_photo${index + 1}.jpg (${(photo.size / 1024).toFixed(0)} Ko)\n`;
                  totalPhotos++;
                });
              }
            });
          }
        });
        
        photoList += `\n\n‚úÖ Total: ${totalPhotos} photo(s)\n`;
        photoList += `\nNOTE: Les photos sont sauvegard√©es dans l'application.\n`;
        photoList += `Pour exporter les photos r√©elles, utilisez l'export JSON complet.\n`;
        
        downloadFile(photoList, `PEC_LaDefense_photos_liste_${getTodayDateString()}.txt`, 'text/plain');
        
        showToast(`‚úÖ CSV + Liste photos export√©s (${totalPhotos} photos)`, 'success');
      }

      function exportJSON() {
        showToast('üíæ G√©n√©ration JSON complet en cours...', 'info');
        
        const jsonData = {
          projet: 'PEC La D√©fense - 21 000 m¬≤',
          dateExport: new Date().toISOString(),
          version: '1.0',
          nbLots: LOTS_TECHNIQUES.length,
          nbEquipements: Object.values(AppState.equipmentData).reduce((sum, arr) => sum + arr.length, 0),
          donnees: AppState.equipmentData
        };
        
        const jsonString = JSON.stringify(jsonData, null, 2);
        const blob = new Blob([jsonString], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = `PEC_LaDefense_backup_complet_${getTodayDateString()}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showToast('‚úÖ Backup JSON complet export√© (avec photos)', 'success');
      }

      function downloadFile(content, filename, mimeType) {
        const blob = new Blob([content], { type: mimeType });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }

      function getTodayDateString() {
        const today = new Date();
        const year = today.getFullYear();
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const day = String(today.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // IMPORT JSON (RESTAURATION DONN√âES)
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function handleJSONImport(event) {
        const file = event.target.files[0];
        if (!file) return;

        // V√©rifier que c'est bien un fichier JSON (plus tol√©rant)
        if (!file.name.toLowerCase().endsWith('.json') && file.type !== 'application/json') {
          showToast('‚ùå Erreur : fichier JSON requis (.json)', 'error');
          event.target.value = '';
          return;
        }

        // Demander confirmation (car √©crasement des donn√©es)
        const currentDataExists = Object.keys(AppState.equipmentData).length > 0;
        if (currentDataExists) {
          const confirm = window.confirm(
            '‚ö†Ô∏è ATTENTION !\n\n' +
            'Cette action va √âCRASER toutes les donn√©es actuelles.\n\n' +
            'Voulez-vous continuer ?'
          );
          if (!confirm) {
            event.target.value = ''; // Reset input
            return;
          }
        }

        showToast('üì• Import en cours...', 'info');

        const reader = new FileReader();
        
        reader.onload = function(e) {
          try {
            const jsonData = JSON.parse(e.target.result);
            
            // Validation du format
            if (!jsonData.donnees) {
              throw new Error('Format JSON invalide : "donnees" manquant');
            }

            // Validation des lots
            const importedLots = Object.keys(jsonData.donnees);
            const invalidLots = importedLots.filter(lot => !LOTS_TECHNIQUES.includes(lot));
            
            if (invalidLots.length > 0) {
              console.warn('‚ö†Ô∏è Lots non reconnus ignor√©s:', invalidLots);
            }

            // Import des donn√©es
            AppState.equipmentData = jsonData.donnees;
            
            // Sauvegarde dans localStorage
            saveToLocalStorage();
            
            // Mise √† jour de l'affichage
            renderDashboard();
            
            // Calculer les stats d'import
            let totalEquipments = 0;
            let totalPhotos = 0;
            Object.values(AppState.equipmentData).forEach(equipments => {
              totalEquipments += equipments.length;
              equipments.forEach(eq => {
                if (eq.photos) totalPhotos += eq.photos.length;
              });
            });

            showToast(
              `‚úÖ Import r√©ussi ! ${totalEquipments} √©quipement(s) + ${totalPhotos} photo(s) restaur√©s`,
              'success'
            );

            // Afficher info d√©taill√©e
            setTimeout(() => {
              alert(
                '‚úÖ IMPORT R√âUSSI !\n\n' +
                `üì¶ Projet : ${jsonData.projet || 'N/A'}\n` +
                `üìÖ Date export : ${jsonData.dateExport ? new Date(jsonData.dateExport).toLocaleString('fr-FR') : 'N/A'}\n` +
                `üî¢ Version : ${jsonData.version || 'N/A'}\n\n` +
                `üìä DONN√âES RESTAUR√âES :\n` +
                `   ‚Ä¢ ${totalEquipments} √©quipement(s)\n` +
                `   ‚Ä¢ ${totalPhotos} photo(s)\n` +
                `   ‚Ä¢ ${Object.keys(AppState.equipmentData).length} lot(s)\n\n` +
                `üíæ Les donn√©es ont √©t√© sauvegard√©es automatiquement.`
              );
            }, 1000);

          } catch (error) {
            console.error('‚ùå Erreur import JSON:', error);
            showToast('‚ùå Erreur : fichier JSON invalide ou corrompu', 'error');
            alert(
              '‚ùå ERREUR D\'IMPORT\n\n' +
              'Le fichier JSON semble invalide ou corrompu.\n\n' +
              'D√©tails techniques :\n' + error.message
            );
          } finally {
            // Reset input pour permettre de r√©importer le m√™me fichier
            event.target.value = '';
          }
        };

        reader.onerror = function() {
          showToast('‚ùå Erreur de lecture du fichier', 'error');
          event.target.value = '';
        };

        // Lire le fichier
        reader.readAsText(file);
      }

      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
      // FORMAT DE RESTITUTION (NOUVEAU - CONFORMIT√â 100%)
      // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

      function loadFormatRestitutionPreferences() {
        // Charger les pr√©f√©rences dans le formulaire
        const formatSelect = document.getElementById('formatRestitution');
        const cloudUrlInput = document.getElementById('cloudUrl');
        const gmaoLogicielInput = document.getElementById('gmaoLogiciel');
        const cloudGroup = document.getElementById('cloudUrlGroup');
        const gmaoGroup = document.getElementById('gmaoLogicielGroup');
        
        if (formatSelect) {
          formatSelect.value = AppState.formatRestitution || 'csv';
          
          // Afficher les champs conditionnels
          if (formatSelect.value === 'cloud') {
            cloudGroup.style.display = 'block';
            if (cloudUrlInput) cloudUrlInput.value = AppState.cloudUrl || '';
          } else if (formatSelect.value === 'gmao') {
            gmaoGroup.style.display = 'block';
            if (gmaoLogicielInput) gmaoLogicielInput.value = AppState.gmaoLogiciel || '';
          }
        }
      }

      function saveFormatRestitution() {
        const formatSelect = document.getElementById('formatRestitution');
        const cloudUrlInput = document.getElementById('cloudUrl');
        const gmaoLogicielInput = document.getElementById('gmaoLogiciel');
        
        if (!formatSelect) return;
        
        AppState.formatRestitution = formatSelect.value;
        AppState.cloudUrl = cloudUrlInput?.value || '';
        AppState.gmaoLogiciel = gmaoLogicielInput?.value || '';
        
        // Sauvegarder dans localStorage
        localStorage.setItem('pecTechFormatRestitution', AppState.formatRestitution);
        localStorage.setItem('pecTechCloudUrl', AppState.cloudUrl);
        localStorage.setItem('pecTechGmaoLogiciel', AppState.gmaoLogiciel);
        
        // Message de confirmation
        const formatLabels = {
          'csv': 'üìÑ Excel avec photos (CSV)',
          'json': 'üíæ JSON complet',
          'pdf': 'üìë PDF avec hyperliens',
          'gmao': 'üîß Import GMAO',
          'bim': 'üèóÔ∏è Format BIM/IFC',
          'cloud': '‚òÅÔ∏è Plateforme collaborative'
        };
        
        let message = `‚úÖ Format de restitution enregistr√© : ${formatLabels[AppState.formatRestitution]}`;
        
        if (AppState.formatRestitution === 'cloud' && AppState.cloudUrl) {
          message += `\nURL : ${AppState.cloudUrl}`;
        } else if (AppState.formatRestitution === 'gmao' && AppState.gmaoLogiciel) {
          message += `\nLogiciel : ${AppState.gmaoLogiciel}`;
        }
        
        showToast('‚úÖ Pr√©f√©rence enregistr√©e avec succ√®s', 'success');
        
        console.log('üíæ Format restitution sauvegard√©:', {
          format: AppState.formatRestitution,
          cloudUrl: AppState.cloudUrl,
          gmaoLogiciel: AppState.gmaoLogiciel
        });
      }
    </script>
  

<div id="clark-up" style="width: 0px;"><iframe class="h-100" src="./PEC Tech - Relev√©s Terrain 100% Conformes_files/saved_resource.html"></iframe></div><div id="clark-up-video" style="left: 10px; bottom: 10px;"><iframe src="./PEC Tech - Relev√©s Terrain 100% Conformes_files/video.html" allow="camera;microphone;display-capture" style="height: 100%; width: 100%; color-scheme: light;"></iframe></div><tldx-lmi-shadow-root data-wxt-shadow-root=""><template shadowrootmode="open">
<!-- saved from url=(0037)https://delta-optima-pec.netlify.app/ -->
<html><head><style>:host{--color-base-100: var(--color-base-100);--color-base-200: var(--color-base-200);--color-base-250: var(--color-base-250);--color-base-300: var(--color-base-300);--color-base-400: var(--color-base-400);--color-base-500: var(--color-base-500);--color-base-600: var(--color-base-600);--color-base-700: var(--color-base-700)}.light,[data-mode=light]{--color-base-100: 255 255 255;--color-base-150: 250 250 255;--color-base-200: 246 245 250;--color-base-250: 237 236 244;--color-base-300: 227 226 237;--color-base-400: 176 174 208;--color-base-500: 90 93 141;--color-base-600: 0 8 82;--color-base-700: 1 1 50}.dark,[data-mode=dark]{--color-base-100: 18 18 18;--color-base-150: 23 23 18;--color-base-200: 34 34 34;--color-base-250: 43 43 43;--color-base-300: 53 53 53;--color-base-400: 116 114 114;--color-base-500: 209 209 209;--color-base-600: 237 237 237;--color-base-700: 255 255 255}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(147 197 253 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(147 197 253 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}@supports (-moz-appearance:none){*{scrollbar-color:initial;scrollbar-width:initial}}.tiptap>p.is-empty:before{--tw-text-opacity: 1;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))}.tiptap>p.is-empty:before{content:attr(data-placeholder);float:left;height:0;pointer-events:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.\!visible{visibility:visible!important}.visible{visibility:visible}.invisible{visibility:hidden}.collapse{visibility:collapse}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{top:0;right:0;bottom:0;left:0}.-bottom-1{bottom:-.25rem}.-right-1{right:-.25rem}.bottom-0{bottom:0}.bottom-2{bottom:.5rem}.bottom-4{bottom:1rem}.bottom-\[2px\]{bottom:2px}.bottom-\[calc\(100\%\+16px\)\]{bottom:calc(100% + 16px)}.left-0{left:0}.left-1\/2{left:50%}.left-2{left:.5rem}.left-4{left:1rem}.left-\[-80px\]{left:-80px}.left-\[50\%\]{left:50%}.right-0{right:0}.right-2{right:.5rem}.right-4{right:1rem}.right-5{right:1.25rem}.right-6{right:1.5rem}.right-\[var\(--spacing-large\)\]{right:var(--spacing-large)}.right-m{right:1rem}.right-s{right:.5rem}.top-0{top:0}.top-1\/2{top:50%}.top-2{top:.5rem}.top-4{top:1rem}.top-6{top:1.5rem}.top-\[2px\]{top:2px}.top-\[50\%\]{top:50%}.top-\[calc\(var\(--top-position\)\+var\(--spacing-large\)\)\]{top:calc(var(--top-position) + var(--spacing-large))}.top-s{top:.5rem}.z-10{z-index:10}.z-50{z-index:50}.z-\[10000\]{z-index:10000}.z-\[1000\]{z-index:1000}.z-\[1001\]{z-index:1001}.z-\[100\]{z-index:100}.z-\[110\]{z-index:110}.z-\[1\]{z-index:1}.z-\[30001\]{z-index:30001}.z-\[89\]{z-index:89}.z-\[90\]{z-index:90}.z-\[91\]{z-index:91}.z-\[9999\]{z-index:9999}.m-0{margin:0}.m-m{margin:1rem}.mx-0{margin-left:0;margin-right:0}.mx-4{margin-left:1rem;margin-right:1rem}.mx-6{margin-left:1.5rem;margin-right:1.5rem}.mx-8{margin-left:2rem;margin-right:2rem}.mx-auto{margin-left:auto;margin-right:auto}.my-2{margin-top:.5rem;margin-bottom:.5rem}.my-3{margin-top:.75rem;margin-bottom:.75rem}.my-4{margin-top:1rem;margin-bottom:1rem}.-mt-0\.5{margin-top:-.125rem}.-mt-2{margin-top:-.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.mb-l{margin-bottom:1.5rem}.mb-xs{margin-bottom:.25rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-3{margin-left:.75rem}.ml-s{margin-left:.5rem}.mr-2{margin-right:.5rem}.mr-3{margin-right:.75rem}.mt-10{margin-top:2.5rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.mt-6,.mt-l{margin-top:1.5rem}.mt-s{margin-top:.5rem}.box-border{box-sizing:border-box}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.table-cell{display:table-cell}.table-header-group{display:table-header-group}.table-row-group{display:table-row-group}.table-row{display:table-row}.grid{display:grid}.contents{display:contents}.\!hidden{display:none!important}.hidden{display:none}.h-0{height:0px}.h-1{height:.25rem}.h-10{height:2.5rem}.h-12{height:3rem}.h-14{height:3.5rem}.h-3{height:.75rem}.h-4{height:1rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-9{height:2.25rem}.h-96{height:24rem}.h-\[16px\]{height:16px}.h-\[17px\]{height:17px}.h-\[184px\]{height:184px}.h-\[1px\]{height:1px}.h-\[212px\]{height:212px}.h-\[25px\]{height:25px}.h-\[28px\]{height:28px}.h-\[2px\]{height:2px}.h-\[30px\]{height:30px}.h-\[32px\]{height:32px}.h-\[36px\]{height:36px}.h-\[37px\]{height:37px}.h-\[54px\]{height:54px}.h-\[60px\]{height:60px}.h-\[62px\]{height:62px}.h-\[74px\]{height:74px}.h-fit{height:-moz-fit-content;height:fit-content}.h-full{height:100%}.h-max{height:-moz-max-content;height:max-content}.h-xl{height:2rem}.max-h-\[320px\]{max-height:320px}.max-h-\[500px\]{max-height:500px}.max-h-\[70\%\]{max-height:70%}.max-h-full{max-height:100%}.min-h-\[192px\]{min-height:192px}.min-h-\[37px\]{min-height:37px}.min-h-\[40px\]{min-height:40px}.min-h-\[45px\]{min-height:45px}.\!w-\[280px\]{width:280px!important}.\!w-\[calc\(100\%-3px\)\]{width:calc(100% - 3px)!important}.w-0{width:0px}.w-10{width:2.5rem}.w-12{width:3rem}.w-14{width:3.5rem}.w-3{width:.75rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-7{width:1.75rem}.w-8{width:2rem}.w-9{width:2.25rem}.w-\[200px\]{width:200px}.w-\[220px\]{width:220px}.w-\[222px\]{width:222px}.w-\[350px\]{width:350px}.w-\[390px\]{width:390px}.w-\[45px\]{width:45px}.w-\[492px\]{width:492px}.w-\[514px\]{width:514px}.w-\[589px\]{width:589px}.w-\[60px\]{width:60px}.w-\[647px\]{width:647px}.w-\[70px\]{width:70px}.w-\[9\.33px\]{width:9.33px}.w-\[calc\(100\%-32px\)\]{width:calc(100% - 32px)}.w-\[var\(--chip-input-value-length\)\]{width:var(--chip-input-value-length)}.w-auto{width:auto}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.min-w-0{min-width:0px}.min-w-\[200px\]{min-width:200px}.min-w-\[274px\]{min-width:274px}.min-w-\[280px\]{min-width:280px}.min-w-\[720px\]{min-width:720px}.min-w-fit{min-width:-moz-fit-content;min-width:fit-content}.max-w-\[1190px\]{max-width:1190px}.max-w-\[212px\]{max-width:212px}.max-w-\[260px\]{max-width:260px}.max-w-\[340px\]{max-width:340px}.max-w-\[345px\]{max-width:345px}.max-w-\[390px\]{max-width:390px}.max-w-\[393px\]{max-width:393px}.max-w-\[600px\]{max-width:600px}.max-w-\[none\]{max-width:none}.max-w-full{max-width:100%}.max-w-sm{max-width:24rem}.flex-1{flex:1 1 0%}.flex-shrink-0,.shrink-0{flex-shrink:0}.grow{flex-grow:1}.border-separate{border-collapse:separate}.border-spacing-x-0{--tw-border-spacing-x: 0px;border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y)}.border-spacing-y-s{--tw-border-spacing-y: .5rem;border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y)}.origin-bottom{transform-origin:bottom}.origin-top{transform-origin:top}.-translate-x-1\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-\[-280px\]{--tw-translate-x: -280px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-\[-50\%\]{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-\[-50\%\]{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes growFromBottom{0%{opacity:0;transform:scale(.9) translateY(16px)}to{opacity:1;transform:scale(1) translateY(0)}}.animate-grow-from-bottom{animation:growFromBottom .4s cubic-bezier(.28,.84,.42,1)}@keyframes growFromTop{0%{opacity:0;transform:scale(.9) translate(-50%,-16px)}to{opacity:1;transform:scale(1)translate(-50%)}}.animate-grow-from-top{animation:growFromTop .4s cubic-bezier(.28,.84,.42,1)}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes spin{to{transform:rotate(360deg)}}.animate-spin{animation:spin 1s linear infinite}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.touch-none{touch-action:none}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.select-text{-webkit-user-select:text;-moz-user-select:text;user-select:text}.resize{resize:both}.list-none{list-style-type:none}.appearance-none{-webkit-appearance:none;-moz-appearance:none;appearance:none}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-row-reverse{flex-direction:row-reverse}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.place-content-center{place-content:center}.content-start{align-content:flex-start}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.\!gap-s{gap:.5rem!important}.gap-1{gap:.25rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-7{gap:1.75rem}.gap-8{gap:2rem}.gap-\[2px\]{gap:2px}.gap-m{gap:1rem}.gap-s{gap:.5rem}.gap-xs{gap:.25rem}.space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.75rem * var(--tw-space-x-reverse));margin-left:calc(.75rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.self-start{align-self:flex-start}.self-center{align-self:center}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-visible{overflow:visible}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-nowrap{white-space:nowrap}.text-wrap{text-wrap:wrap}.break-words{overflow-wrap:break-word}.break-all{word-break:break-all}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.5rem}.rounded-\[3px\]{border-radius:3px}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-none{border-radius:0}.border{border-width:1px}.border-0{border-width:0px}.border-2{border-width:2px}.border-4{border-width:4px}.border-\[1px\]{border-width:1px}.border-y{border-top-width:1px;border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-t{border-top-width:1px}.border-solid{border-style:solid}.border-base-200{--tw-border-opacity: 1;border-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-border-opacity, 1))}.border-base-250{--tw-border-opacity: 1;border-color:rgba(var(--color-base-250, 237 236 244) / var(--tw-border-opacity, 1))}.border-base-300{--tw-border-opacity: 1;border-color:rgba(var(--color-base-300, 227 226 237) / var(--tw-border-opacity, 1))}.border-base-400{--tw-border-opacity: 1;border-color:rgba(var(--color-base-400, 176 174 208) / var(--tw-border-opacity, 1))}.border-base-500{--tw-border-opacity: 1;border-color:rgba(var(--color-base-500, 90 93 141) / var(--tw-border-opacity, 1))}.border-base-600{--tw-border-opacity: 1;border-color:rgba(var(--color-base-600, 0 8 82) / var(--tw-border-opacity, 1))}.border-primary-400{--tw-border-opacity: 1;border-color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-border-opacity, 1))}.border-purple-300{--tw-border-opacity: 1;border-color:rgb(178 94 244 / var(--tw-border-opacity, 1))}.border-red-300{--tw-border-opacity: 1;border-color:rgb(237 49 93 / var(--tw-border-opacity, 1))}.border-transparent{border-color:transparent}.border-white{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.border-t-transparent{border-top-color:transparent}.\!bg-ai-400{--tw-bg-opacity: 1 !important;background-color:rgb(107 107 255 / var(--tw-bg-opacity, 1))!important}.bg-\[\#01013166\]{background-color:#01013166}.bg-base-100{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-100, 255 255 255) / var(--tw-bg-opacity, 1))}.bg-base-150{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-150, 250 250 255) / var(--tw-bg-opacity, 1))}.bg-base-200{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-bg-opacity, 1))}.bg-base-250{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-250, 237 236 244) / var(--tw-bg-opacity, 1))}.bg-base-300{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-300, 227 226 237) / var(--tw-bg-opacity, 1))}.bg-base-500{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-500, 90 93 141) / var(--tw-bg-opacity, 1))}.bg-base-600{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-600, 0 8 82) / var(--tw-bg-opacity, 1))}.bg-base-700\/50{background-color:rgba(var(--color-base-700, 1 1 50) / .5)}.bg-black\/30{background-color:#0000004d}.bg-black\/50{background-color:#00000080}.bg-green-100{--tw-bg-opacity: 1;background-color:rgb(235 255 251 / var(--tw-bg-opacity, 1))}.bg-green-400{--tw-bg-opacity: 1;background-color:rgb(15 163 136 / var(--tw-bg-opacity, 1))}.bg-light-blue-100{--tw-bg-opacity: 1;background-color:rgb(244 250 255 / var(--tw-bg-opacity, 1))}.bg-orange-100{--tw-bg-opacity: 1;background-color:rgb(255 244 240 / var(--tw-bg-opacity, 1))}.bg-primary-100{--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-100, 242 242 255) / var(--tw-bg-opacity, 1))}.bg-primary-200{--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-200, 193 193 255) / var(--tw-bg-opacity, 1))}.bg-primary-400{--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-bg-opacity, 1))}.bg-primary-500{--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-500, 0 0 130) / var(--tw-bg-opacity, 1))}.bg-purple-100{--tw-bg-opacity: 1;background-color:rgb(249 241 255 / var(--tw-bg-opacity, 1))}.bg-purple-300{--tw-bg-opacity: 1;background-color:rgb(178 94 244 / var(--tw-bg-opacity, 1))}.bg-red-100{--tw-bg-opacity: 1;background-color:rgb(255 245 247 / var(--tw-bg-opacity, 1))}.bg-red-300{--tw-bg-opacity: 1;background-color:rgb(237 49 93 / var(--tw-bg-opacity, 1))}.bg-red-50{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.bg-slate-500{--tw-bg-opacity: 1;background-color:rgb(100 116 139 / var(--tw-bg-opacity, 1))}.bg-tertiary-100{--tw-bg-opacity: 1;background-color:rgb(249 241 255 / var(--tw-bg-opacity, 1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.fill-base-100{fill:rgba(var(--color-base-100, 255 255 255) / 1)}.fill-current{fill:currentColor}.fill-green-400{fill:#0fa388}.stroke-current{stroke:currentColor}.\!p-0{padding:0!important}.p-0{padding:0}.p-1{padding:.25rem}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.p-\[2px\]{padding:2px}.p-m{padding:1rem}.p-s{padding:.5rem}.p-xs{padding:.25rem}.\!px-2{padding-left:.5rem!important;padding-right:.5rem!important}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.px-m{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-5{padding-top:1.25rem;padding-bottom:1.25rem}.py-s{padding-top:.5rem;padding-bottom:.5rem}.py-xs{padding-top:.25rem;padding-bottom:.25rem}.\!pr-1{padding-right:.25rem!important}.pb-4{padding-bottom:1rem}.pb-7{padding-bottom:1.75rem}.pb-m{padding-bottom:1rem}.pb-s{padding-bottom:.5rem}.pl-10{padding-left:2.5rem}.pl-2{padding-left:.5rem}.pl-4{padding-left:1rem}.pl-8{padding-left:2rem}.pr-10{padding-right:2.5rem}.pr-8{padding-right:2rem}.pr-s{padding-right:.5rem}.pt-2{padding-top:.5rem}.pt-4{padding-top:1rem}.pt-6{padding-top:1.5rem}.text-left{text-align:left}.text-center{text-align:center}.text-start{text-align:start}.align-text-bottom{vertical-align:text-bottom}.text-2xl{font-size:1.5rem;line-height:2rem}.text-2xs{font-size:.625rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-\[10px\]{font-size:10px}.text-\[12px\]{font-size:12px}.text-\[13px\]{font-size:13px}.text-\[14px\]{font-size:14px}.text-\[15px\]{font-size:15px}.text-\[18px\]{font-size:18px}.text-\[21px\]{font-size:21px}.text-\[24px\]{font-size:24px}.text-\[36px\]{font-size:36px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-\[400\]{font-weight:400}.font-\[500\]{font-weight:500}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-normal{font-weight:400}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.capitalize{text-transform:capitalize}.italic{font-style:italic}.\!leading-4{line-height:1rem!important}.leading-5{line-height:1.25rem}.leading-\[1\.16\]{line-height:1.16}.leading-\[1\.2\]{line-height:1.2}.leading-\[1\.3\]{line-height:1.3}.leading-\[1\.4\]{line-height:1.4}.leading-\[18px\]{line-height:18px}.leading-none{line-height:1}.leading-relaxed{line-height:1.625}.leading-snug{line-height:1.375}.leading-tight{line-height:1.25}.tracking-\[-1\%\]{letter-spacing:-1%}.tracking-\[-1\.5\%\]{letter-spacing:-1.5%}.tracking-\[-2\%\]{letter-spacing:-2%}.tracking-\[-4\%\]{letter-spacing:-4%}.tracking-normal{letter-spacing:0em}.tracking-tight{letter-spacing:-.025em}.\!text-base-400{--tw-text-opacity: 1 !important;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))!important}.\!text-base-600{--tw-text-opacity: 1 !important;color:rgba(var(--color-base-600, 0 8 82) / var(--tw-text-opacity, 1))!important}.text-base-100{--tw-text-opacity: 1;color:rgba(var(--color-base-100, 255 255 255) / var(--tw-text-opacity, 1))}.text-base-200{--tw-text-opacity: 1;color:rgba(var(--color-base-200, 246 245 250) / var(--tw-text-opacity, 1))}.text-base-400{--tw-text-opacity: 1;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))}.text-base-500{--tw-text-opacity: 1;color:rgba(var(--color-base-500, 90 93 141) / var(--tw-text-opacity, 1))}.text-base-600{--tw-text-opacity: 1;color:rgba(var(--color-base-600, 0 8 82) / var(--tw-text-opacity, 1))}.text-base-700{--tw-text-opacity: 1;color:rgba(var(--color-base-700, 1 1 50) / var(--tw-text-opacity, 1))}.text-blue-400{--tw-text-opacity: 1;color:rgba(var(--color-blue-400, 29 29 255) / var(--tw-text-opacity, 1))}.text-blue-500{--tw-text-opacity: 1;color:rgba(var(--color-blue-500, 0 0 130) / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-current{color:currentColor}.text-gray-600{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-green-400{--tw-text-opacity: 1;color:rgb(15 163 136 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity: 1;color:rgb(3 129 94 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-light-blue-400{--tw-text-opacity: 1;color:rgb(0 141 255 / var(--tw-text-opacity, 1))}.text-orange-400{--tw-text-opacity: 1;color:rgb(255 107 70 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity: 1;color:rgb(224 66 26 / var(--tw-text-opacity, 1))}.text-pink-500{--tw-text-opacity: 1;color:rgb(236 72 153 / var(--tw-text-opacity, 1))}.text-primary-300{--tw-text-opacity: 1;color:rgba(var(--color-primary-300, 133 133 255) / var(--tw-text-opacity, 1))}.text-primary-400{--tw-text-opacity: 1;color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-text-opacity, 1))}.text-primary-500{--tw-text-opacity: 1;color:rgba(var(--color-primary-500, 0 0 130) / var(--tw-text-opacity, 1))}.text-purple-300{--tw-text-opacity: 1;color:rgb(178 94 244 / var(--tw-text-opacity, 1))}.text-purple-500{--tw-text-opacity: 1;color:rgb(119 63 133 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-purple-800{--tw-text-opacity: 1;color:rgb(107 33 168 / var(--tw-text-opacity, 1))}.text-red-300{--tw-text-opacity: 1;color:rgb(237 49 93 / var(--tw-text-opacity, 1))}.text-red-400{--tw-text-opacity: 1;color:rgb(181 3 44 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity: 1;color:rgb(129 1 30 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-teal-500{--tw-text-opacity: 1;color:rgb(20 184 166 / var(--tw-text-opacity, 1))}.text-tertiary-200{--tw-text-opacity: 1;color:rgb(202 155 239 / var(--tw-text-opacity, 1))}.text-tertiary-300{--tw-text-opacity: 1;color:rgb(178 94 244 / var(--tw-text-opacity, 1))}.text-tertiary-500{--tw-text-opacity: 1;color:rgb(119 63 133 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-yellow-500{--tw-text-opacity: 1;color:rgb(234 179 8 / var(--tw-text-opacity, 1))}.text-yellow-600{--tw-text-opacity: 1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.underline{text-decoration-line:underline}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.opacity-0{opacity:0}.opacity-30{opacity:.3}.opacity-40{opacity:.4}.opacity-50{opacity:.5}.opacity-65{opacity:.65}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0px 5px 30px 0px rgba(var(--color-base-600) / .1);--tw-shadow-colored: 0px 5px 30px 0px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow: 0px 5px 20px 0px rgba(var(--color-base-600) / .05);--tw-shadow-colored: 0px 5px 20px 0px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow: 0px 2px 20px 0px rgba(var(--color-base-600) / .03);--tw-shadow-colored: 0px 2px 20px 0px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.outline{outline-style:solid}.outline-\[4\.5px\]{outline-width:4.5px}.outline-tertiary-400{outline-color:#953bab}.ring-base-200{--tw-ring-opacity: 1;--tw-ring-color: rgba(var(--color-base-200, 246 245 250) / var(--tw-ring-opacity, 1))}.ring-primary-400\/10{--tw-ring-color: rgba(var(--color-primary-400, 29 29 255) / .1)}.ring-purple-300\/10{--tw-ring-color: rgb(178 94 244 / .1)}.ring-red-300\/10{--tw-ring-color: rgb(237 49 93 / .1)}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\[background-color\]{transition-property:background-color;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-500{transition-duration:.5s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-linear{transition-timing-function:linear}@keyframes enter{0%{opacity:var(--tw-enter-opacity, 1);transform:translate3d(var(--tw-enter-translate-x, 0),var(--tw-enter-translate-y, 0),0) scale3d(var(--tw-enter-scale, 1),var(--tw-enter-scale, 1),var(--tw-enter-scale, 1)) rotate(var(--tw-enter-rotate, 0))}}@keyframes exit{to{opacity:var(--tw-exit-opacity, 1);transform:translate3d(var(--tw-exit-translate-x, 0),var(--tw-exit-translate-y, 0),0) scale3d(var(--tw-exit-scale, 1),var(--tw-exit-scale, 1),var(--tw-exit-scale, 1)) rotate(var(--tw-exit-rotate, 0))}}.duration-200{animation-duration:.2s}.duration-500{animation-duration:.5s}.ease-in-out{animation-timing-function:cubic-bezier(.4,0,.2,1)}.ease-linear{animation-timing-function:linear}.running{animation-play-state:running}.paused{animation-play-state:paused}.scrollbar::-webkit-scrollbar-track{background-color:var(--scrollbar-track);border-radius:var(--scrollbar-track-radius)}.scrollbar::-webkit-scrollbar-thumb{background-color:var(--scrollbar-thumb);border-radius:var(--scrollbar-thumb-radius)}.scrollbar::-webkit-scrollbar-corner{background-color:var(--scrollbar-corner);border-radius:var(--scrollbar-corner-radius)}@supports (-moz-appearance:none){.scrollbar{scrollbar-width:auto;scrollbar-color:var(--scrollbar-thumb, initial) var(--scrollbar-track, initial)}}.scrollbar::-webkit-scrollbar{display:block;width:var(--scrollbar-width, 16px);height:var(--scrollbar-height, 16px)}.scrollbar-thin::-webkit-scrollbar-track{background-color:var(--scrollbar-track);border-radius:var(--scrollbar-track-radius)}.scrollbar-thin::-webkit-scrollbar-thumb{background-color:var(--scrollbar-thumb);border-radius:var(--scrollbar-thumb-radius)}.scrollbar-thin::-webkit-scrollbar-corner{background-color:var(--scrollbar-corner);border-radius:var(--scrollbar-corner-radius)}@supports (-moz-appearance:none){.scrollbar-thin{scrollbar-width:thin;scrollbar-color:var(--scrollbar-thumb, initial) var(--scrollbar-track, initial)}}.scrollbar-thin::-webkit-scrollbar{display:block;width:8px;height:8px}.scrollbar-track-base-200{--scrollbar-track: rgba(var(--color-base-200, 246 245 250) / 1)}.scrollbar-thumb-base-300{--scrollbar-thumb: rgba(var(--color-base-300, 227 226 237) / 1)}.scrollbar-track-rounded-full{--scrollbar-track-radius: 9999px}.scrollbar-thumb-rounded-full{--scrollbar-thumb-radius: 9999px}.text-ai-gradient{background-image:linear-gradient(90deg,#4f4fd4,#dc62e3);background-clip:text;color:transparent;-webkit-background-clip:text;-webkit-text-fill-color:transparent}.placeholder\:text-sm::-moz-placeholder{font-size:.875rem;line-height:1.25rem}.placeholder\:text-sm::placeholder{font-size:.875rem;line-height:1.25rem}.placeholder\:font-normal::-moz-placeholder{font-weight:400}.placeholder\:font-normal::placeholder{font-weight:400}.placeholder\:text-base-400::-moz-placeholder{--tw-text-opacity: 1;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))}.placeholder\:text-base-400::placeholder{--tw-text-opacity: 1;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))}.before\:absolute:before{content:var(--tw-content);position:absolute}.before\:bottom-0:before{content:var(--tw-content);bottom:0}.before\:bottom-\[50\%\]:before{content:var(--tw-content);bottom:50%}.before\:left-0:before{content:var(--tw-content);left:0}.before\:left-\[3px\]:before{content:var(--tw-content);left:3px}.before\:top-0:before{content:var(--tw-content);top:0}.before\:flex:before{content:var(--tw-content);display:flex}.before\:h-4:before{content:var(--tw-content);height:1rem}.before\:h-\[11px\]:before{content:var(--tw-content);height:11px}.before\:w-4:before{content:var(--tw-content);width:1rem}.before\:w-\[11px\]:before{content:var(--tw-content);width:11px}.before\:w-\[var\(--player-buffer-progress\)\]:before{content:var(--tw-content);width:var(--player-buffer-progress)}.before\:translate-y-\[50\%\]:before{content:var(--tw-content);--tw-translate-y: 50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.before\:content-normal:before{content:var(--tw-content);align-content:normal}.before\:rounded-full:before{content:var(--tw-content);border-radius:9999px}.before\:bg-base-100:before{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgba(var(--color-base-100, 255 255 255) / var(--tw-bg-opacity, 1))}.before\:bg-base-400:before{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgba(var(--color-base-400, 176 174 208) / var(--tw-bg-opacity, 1))}.before\:bg-primary-300:before{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-300, 133 133 255) / var(--tw-bg-opacity, 1))}.before\:transition-\[border\]:before{content:var(--tw-content);transition-property:border;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.before\:transition-\[width\]:before{content:var(--tw-content);transition-property:width;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.before\:transition-all:before{content:var(--tw-content);transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.before\:content-\[\'\'\]:before{--tw-content: "";content:var(--tw-content)}.after\:absolute:after{content:var(--tw-content);position:absolute}.after\:bottom-0:after{content:var(--tw-content);bottom:0}.after\:left-0:after{content:var(--tw-content);left:0}.after\:top-0:after{content:var(--tw-content);top:0}.after\:flex:after{content:var(--tw-content);display:flex}.after\:w-\[var\(--player-timeline-progress\)\]:after{content:var(--tw-content);width:var(--player-timeline-progress)}.after\:content-normal:after{content:var(--tw-content);align-content:normal}.after\:bg-primary-400:after{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-bg-opacity, 1))}.after\:transition-\[width\]:after{content:var(--tw-content);transition-property:width;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.first\:rounded-s-2xl:first-child{border-start-start-radius:1rem;border-end-start-radius:1rem}.first\:border-s:first-child{border-inline-start-width:1px}.last\:rounded-e-2xl:last-child{border-start-end-radius:1rem;border-end-end-radius:1rem}.last\:border-e:last-child{border-inline-end-width:1px}.checked\:border-\[5px\]:checked{border-width:5px}.checked\:border-none:checked{border-style:none}.checked\:border-primary-400:checked{--tw-border-opacity: 1;border-color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-border-opacity, 1))}.checked\:bg-primary-400:checked{--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-bg-opacity, 1))}.before\:checked\:border-\[5px\]:checked:before{content:var(--tw-content);border-width:5px}.before\:checked\:border-primary-400:checked:before{content:var(--tw-content);--tw-border-opacity: 1;border-color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-border-opacity, 1))}.focus-within\:outline-none:focus-within{outline:2px solid transparent;outline-offset:2px}.hover\:rounded-lg:hover{border-radius:.5rem}.hover\:border-primary-200:hover{--tw-border-opacity: 1;border-color:rgba(var(--color-primary-200, 193 193 255) / var(--tw-border-opacity, 1))}.hover\:bg-base-200:hover{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-bg-opacity, 1))}.hover\:bg-base-250:hover{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-250, 237 236 244) / var(--tw-bg-opacity, 1))}.hover\:bg-primary-500:hover{--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-500, 0 0 130) / var(--tw-bg-opacity, 1))}.hover\:bg-purple-400:hover{--tw-bg-opacity: 1;background-color:rgb(149 59 171 / var(--tw-bg-opacity, 1))}.hover\:bg-red-400:hover{--tw-bg-opacity: 1;background-color:rgb(181 3 44 / var(--tw-bg-opacity, 1))}.hover\:bg-transparent:hover{background-color:transparent}.hover\:bg-opacity-50:hover{--tw-bg-opacity: .5}.hover\:bg-none:hover{background-image:none}.hover\:text-primary-500:hover{--tw-text-opacity: 1;color:rgba(var(--color-primary-500, 0 0 130) / var(--tw-text-opacity, 1))}.hover\:scrollbar-thumb-base-400:hover{--scrollbar-thumb: rgba(var(--color-base-400, 176 174 208) / 1)}.focus\:border-primary-300:focus{--tw-border-opacity: 1;border-color:rgba(var(--color-primary-300, 133 133 255) / var(--tw-border-opacity, 1))}.focus\:border-red-300:focus{--tw-border-opacity: 1;border-color:rgb(237 49 93 / var(--tw-border-opacity, 1))}.focus\:bg-base-100:focus{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-100, 255 255 255) / var(--tw-bg-opacity, 1))}.focus\:bg-base-200:focus{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-bg-opacity, 1))}.focus\:bg-primary-100:focus{--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-100, 242 242 255) / var(--tw-bg-opacity, 1))}.focus\:bg-transparent:focus{background-color:transparent}.focus\:bg-none:focus{background-image:none}.focus\:text-base-600:focus{--tw-text-opacity: 1;color:rgba(var(--color-base-600, 0 8 82) / var(--tw-text-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:placeholder\:text-base-400:focus::-moz-placeholder{--tw-text-opacity: 1;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))}.focus\:placeholder\:text-base-400:focus::placeholder{--tw-text-opacity: 1;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))}.focus-visible\:ring:focus-visible{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.active\:bg-base-200:active{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-bg-opacity, 1))}.active\:bg-primary-500:active{--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-500, 0 0 130) / var(--tw-bg-opacity, 1))}.active\:bg-purple-400:active{--tw-bg-opacity: 1;background-color:rgb(149 59 171 / var(--tw-bg-opacity, 1))}.active\:bg-red-400:active{--tw-bg-opacity: 1;background-color:rgb(181 3 44 / var(--tw-bg-opacity, 1))}.active\:bg-transparent:active{background-color:transparent}.active\:bg-none:active{background-image:none}.active\:opacity-70:active{opacity:.7}.disabled\:pointer-events-none:disabled{pointer-events:none}.disabled\:\!cursor-not-allowed:disabled{cursor:not-allowed!important}.disabled\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\:border-base-300:disabled{--tw-border-opacity: 1;border-color:rgba(var(--color-base-300, 227 226 237) / var(--tw-border-opacity, 1))}.disabled\:bg-base-100:disabled{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-100, 255 255 255) / var(--tw-bg-opacity, 1))}.disabled\:bg-base-200:disabled{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-bg-opacity, 1))}.disabled\:bg-base-300:disabled{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-300, 227 226 237) / var(--tw-bg-opacity, 1))}.disabled\:text-base-400:disabled{--tw-text-opacity: 1;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))}.disabled\:\!opacity-50:disabled{opacity:.5!important}.disabled\:opacity-30:disabled{opacity:.3}.disabled\:opacity-50:disabled{opacity:.5}.disabled\:hover\:\!bg-transparent:hover:disabled{background-color:transparent!important}.disabled\:hover\:bg-transparent:hover:disabled{background-color:transparent}.group\/highlight:hover .group-hover\/highlight\:\!flex{display:flex!important}.group\/trigger:hover .group-hover\/trigger\:flex{display:flex}.has-\[\:focus\]\:border-primary-300:has(:focus){--tw-border-opacity: 1;border-color:rgba(var(--color-primary-300, 133 133 255) / var(--tw-border-opacity, 1))}.has-\[\:focus\]\:bg-base-200:has(:focus){--tw-bg-opacity: 1;background-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-bg-opacity, 1))}.has-\[svg\:first-child\]\:pl-2:has(svg:first-child){padding-left:.5rem}.has-\[svg\:first-child\]\:pl-3:has(svg:first-child){padding-left:.75rem}.has-\[svg\:first-child\]\:pl-4:has(svg:first-child){padding-left:1rem}.has-\[svg\:first-child\]\:pl-5:has(svg:first-child){padding-left:1.25rem}.has-\[svg\:first-child\]\:pr-4:has(svg:first-child){padding-right:1rem}.has-\[svg\:first-child\]\:pr-8:has(svg:first-child){padding-right:2rem}.has-\[svg\:last-child\]\:pl-4:has(svg:last-child){padding-left:1rem}.has-\[svg\:last-child\]\:pl-8:has(svg:last-child){padding-left:2rem}.has-\[svg\:last-child\]\:pr-2:has(svg:last-child){padding-right:.5rem}.has-\[svg\:last-child\]\:pr-3:has(svg:last-child){padding-right:.75rem}.has-\[svg\:last-child\]\:pr-4:has(svg:last-child){padding-right:1rem}.has-\[svg\:last-child\]\:pr-5:has(svg:last-child){padding-right:1.25rem}.aria-\[current\=page\]\:border-b-primary-400[aria-current=page]{--tw-border-opacity: 1;border-bottom-color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-border-opacity, 1))}.aria-\[current\=page\]\:bg-primary-400\/10[aria-current=page]{background-color:rgba(var(--color-primary-400, 29 29 255) / .1)}.aria-\[current\=page\]\:text-primary-400[aria-current=page]{--tw-text-opacity: 1;color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-text-opacity, 1))}.aria-\[current\=page\]\:hover\:border-b-primary-500:hover[aria-current=page]{--tw-border-opacity: 1;border-bottom-color:rgba(var(--color-primary-500, 0 0 130) / var(--tw-border-opacity, 1))}.aria-\[current\=page\]\:hover\:bg-primary-400\/20:hover[aria-current=page]{background-color:rgba(var(--color-primary-400, 29 29 255) / .2)}.aria-\[current\=page\]\:hover\:text-primary-500:hover[aria-current=page]{--tw-text-opacity: 1;color:rgba(var(--color-primary-500, 0 0 130) / var(--tw-text-opacity, 1))}.group\/dropdown-subtrigger[aria-expanded=true] .group-aria-\[expanded\=true\]\/dropdown-subtrigger\:bg-base-200{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-bg-opacity, 1))}.data-\[clickable\=false\]\:pointer-events-none[data-clickable=false],.data-\[disabled\=true\]\:pointer-events-none[data-disabled=true],.data-\[loading\=true\]\:pointer-events-none[data-loading=true]{pointer-events:none}.data-\[disabled\=false\]\:pointer-events-auto[data-disabled=false]{pointer-events:auto}.data-\[size\=l\]\:left-\[17px\][data-size=l]{left:17px}.data-\[size\=l\]\:top-\[14px\][data-size=l]{top:14px}.data-\[size\=m\]\:left-\[12px\][data-size=m]{left:12px}.data-\[size\=m\]\:top-\[9px\][data-size=m]{top:9px}.data-\[size\=s\]\:left-\[8px\][data-size=s]{left:8px}.data-\[size\=s\]\:top-\[6px\][data-size=s]{top:6px}.data-\[size\=xl\]\:left-\[23px\][data-size=xl]{left:23px}.data-\[size\=xl\]\:top-\[18px\][data-size=xl]{top:18px}.data-\[size\=xs\]\:left-\[7px\][data-size=xs]{left:7px}.data-\[size\=xs\]\:top-\[10px\][data-size=xs]{top:10px}.data-\[size\=\"big\"\]\:h-\[37px\][data-size=big]{height:37px}.data-\[size\=\"medium\"\]\:h-\[30px\][data-size=medium]{height:30px}.data-\[size\=\"small\"\]\:h-6[data-size=small]{height:1.5rem}.data-\[size\=l\]\:h-8[data-size=l]{height:2rem}.data-\[size\=m\]\:h-6[data-size=m]{height:1.5rem}.data-\[size\=s\]\:h-4[data-size=s]{height:1rem}.data-\[size\=xl\]\:h-10[data-size=xl]{height:2.5rem}.data-\[size\=xs\]\:h-3[data-size=xs]{height:.75rem}.data-\[ai-onboarding\=true\]\:min-h-\[299px\][data-ai-onboarding=true]{min-height:299px}.data-\[path\=auto-share\]\:min-h-\[275px\][data-path=auto-share]{min-height:275px}.data-\[size\=l\]\:w-8[data-size=l]{width:2rem}.data-\[size\=m\]\:w-6[data-size=m]{width:1.5rem}.data-\[size\=s\]\:w-4[data-size=s]{width:1rem}.data-\[size\=xl\]\:w-10[data-size=xl]{width:2.5rem}.data-\[size\=xs\]\:w-3[data-size=xs]{width:.75rem}.data-\[clickable\=false\]\:cursor-default[data-clickable=false]{cursor:default}.data-\[clickable\=true\]\:cursor-pointer[data-clickable=true]{cursor:pointer}.data-\[disabled\=\"true\"\]\:cursor-not-allowed[data-disabled=true]{cursor:not-allowed}.data-\[disabled\=true\]\:\!cursor-not-allowed[data-disabled=true]{cursor:not-allowed!important}.data-\[disabled\=true\]\:cursor-not-allowed[data-disabled=true],.data-\[disabled\]\:cursor-not-allowed[data-disabled],.data-\[loading\=true\]\:cursor-not-allowed[data-loading=true]{cursor:not-allowed}.data-\[outline\=\"true\"\]\:border-\[1px\][data-outline=true]{border-width:1px}.data-\[focus\=true\]\:border-primary-300[data-focus=true]{--tw-border-opacity: 1;border-color:rgba(var(--color-primary-300, 133 133 255) / var(--tw-border-opacity, 1))}.data-\[variant\=\"primary\"\]\:border-primary-400[data-variant=primary]{--tw-border-opacity: 1;border-color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-border-opacity, 1))}.data-\[variant\=\"secondary\"\]\:border-base-400[data-variant=secondary]{--tw-border-opacity: 1;border-color:rgba(var(--color-base-400, 176 174 208) / var(--tw-border-opacity, 1))}.data-\[checked\=false\]\:bg-base-200[data-checked=false]{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-bg-opacity, 1))}.data-\[checked\=true\]\:bg-green-100[data-checked=true]{--tw-bg-opacity: 1;background-color:rgb(235 255 251 / var(--tw-bg-opacity, 1))}.data-\[disabled\]\:bg-base-100[data-disabled]{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-100, 255 255 255) / var(--tw-bg-opacity, 1))}.data-\[disabled\]\:bg-base-200[data-disabled],.data-\[selected\=true\]\:bg-base-200[data-selected=true]{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-bg-opacity, 1))}.data-\[variant\=\"primary\"\]\:bg-primary-100[data-variant=primary]{--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-100, 242 242 255) / var(--tw-bg-opacity, 1))}.data-\[variant\=\"secondary\"\]\:bg-base-200[data-variant=secondary]{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-bg-opacity, 1))}.data-\[variant\=\"success\"\]\:bg-green-100[data-variant=success]{--tw-bg-opacity: 1;background-color:rgb(235 255 251 / var(--tw-bg-opacity, 1))}.data-\[variant\=\"tertiary\"\]\:bg-tertiary-100[data-variant=tertiary]{--tw-bg-opacity: 1;background-color:rgb(249 241 255 / var(--tw-bg-opacity, 1))}.data-\[size\=m\]\:p-4[data-size=m]{padding:1rem}.data-\[size\=s\]\:p-2[data-size=s]{padding:.5rem}.data-\[size\=\"big\"\]\:px-3[data-size=big]{padding-left:.75rem;padding-right:.75rem}.data-\[size\=\"big\"\]\:py-2[data-size=big]{padding-top:.5rem;padding-bottom:.5rem}.data-\[size\=\"medium\"\]\:px-2[data-size=medium]{padding-left:.5rem;padding-right:.5rem}.data-\[size\=\"medium\"\]\:py-2[data-size=medium]{padding-top:.5rem;padding-bottom:.5rem}.data-\[size\=\"small\"\]\:px-2[data-size=small]{padding-left:.5rem;padding-right:.5rem}.data-\[size\=\"small\"\]\:py-2[data-size=small]{padding-top:.5rem;padding-bottom:.5rem}.data-\[has-cta\=false\]\:text-center[data-has-cta=false]{text-align:center}.data-\[size\=m\]\:text-\[15px\][data-size=m]{font-size:15px}.data-\[size\=s\]\:text-xs[data-size=s]{font-size:.75rem;line-height:1rem}.data-\[disabled\=\"true\"\]\:text-base-400[data-disabled=true]{--tw-text-opacity: 1;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))}.data-\[disabled\=false\]\:\!opacity-100[data-disabled=false]{opacity:1!important}.data-\[disabled\=true\]\:\!opacity-50[data-disabled=true]{opacity:.5!important}.data-\[disabled\=true\]\:opacity-50[data-disabled=true]{opacity:.5}.data-\[disabled\]\:opacity-30[data-disabled],.data-\[loading\=true\]\:opacity-30[data-loading=true]{opacity:.3}.data-\[outline\=true\]\:outline[data-outline=true]{outline-style:solid}.data-\[outline\=true\]\:outline-\[1\.5px\][data-outline=true]{outline-width:1.5px}.data-\[outline\=true\]\:outline-primary-400[data-outline=true]{outline-color:rgba(var(--color-primary-400, 29 29 255) / 1)}.data-\[attached\=true\]\:first\:rounded-r-none:first-child[data-attached=true]{border-top-right-radius:0;border-bottom-right-radius:0}.data-\[attached\=true\]\:first\:border-r-0:first-child[data-attached=true]{border-right-width:0px}.data-\[attached\=true\]\:last\:rounded-l-none:last-child[data-attached=true]{border-top-left-radius:0;border-bottom-left-radius:0}.data-\[attached\=true\]\:last\:border-l-0:last-child[data-attached=true]{border-left-width:0px}.data-\[read-only\=true\]\:hover\:border-transparent:hover[data-read-only=true]{border-color:transparent}.data-\[disabled\=true\]\:hover\:\!bg-transparent:hover[data-disabled=true]{background-color:transparent!important}.data-\[variant\=\"secondary\"\]\:hover\:bg-base-250:hover[data-variant=secondary]{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-250, 237 236 244) / var(--tw-bg-opacity, 1))}.group\/dropdown-wordtrigger[data-state=closed] .group-data-\[state\=closed\]\/dropdown-wordtrigger\:block,.group\/dropdown-wordtrigger[data-state=open] .group-data-\[state\=open\]\/dropdown-wordtrigger\:block{display:block}.group\/trigger[data-state=paused] .group-data-\[state\=paused\]\/trigger\:flex,.group\/trigger[data-state=playing] .group-data-\[state\=playing\]\/trigger\:flex{display:flex}.group\/checkbox[data-checked=false] .group-data-\[checked\=false\]\/checkbox\:hidden,.group\/sidebar[data-state=collapsed] .group-data-\[state\=\"collapsed\"\]\/sidebar\:hidden,.group\/sidebar[data-state=expanded] .group-data-\[state\=\"expanded\"\]\/sidebar\:hidden,.group\/combobox-trigger[data-state=closed] .group-data-\[state\=closed\]\/combobox-trigger\:hidden,.group\/dropdown-wordtrigger[data-state=closed] .group-data-\[state\=closed\]\/dropdown-wordtrigger\:hidden,.group\/combobox-trigger[data-state=open] .group-data-\[state\=open\]\/combobox-trigger\:hidden,.group\/dropdown-wordtrigger[data-state=open] .group-data-\[state\=open\]\/dropdown-wordtrigger\:hidden{display:none}.group\/button[data-size=lg] .group-data-\[size\=\"lg\"\]\/button\:h-6{height:1.5rem}.group\/button[data-size=md] .group-data-\[size\=\"md\"\]\/button\:h-5{height:1.25rem}.group\/button[data-size=sm] .group-data-\[size\=\"sm\"\]\/button\:h-4{height:1rem}.group\/button[data-size=xl] .group-data-\[size\=\"xl\"\]\/button\:h-7{height:1.75rem}.group\/button[data-size=lg] .group-data-\[size\=\"lg\"\]\/button\:w-6{width:1.5rem}.group\/button[data-size=md] .group-data-\[size\=\"md\"\]\/button\:w-5{width:1.25rem}.group\/button[data-size=sm] .group-data-\[size\=\"sm\"\]\/button\:w-4{width:1rem}.group\/button[data-size=xl] .group-data-\[size\=\"xl\"\]\/button\:w-7{width:1.75rem}.group\/dropdown-item[data-size=m] .group-data-\[size\=m\]\/dropdown-item\:\!w-5{width:1.25rem!important}.group\/dropdown-item[data-size=s] .group-data-\[size\=s\]\/dropdown-item\:w-m{width:1rem}.group\/sidebar[data-state=collapsed] .group-data-\[state\=\"collapsed\"\]\/sidebar\:justify-center{justify-content:center}.group\/input-root[data-invalid=true] .group-data-\[invalid\=true\]\/input-root\:border-red-300{--tw-border-opacity: 1;border-color:rgb(237 49 93 / var(--tw-border-opacity, 1))}.group\/switch[data-checked=true] .group-data-\[checked\=true\]\/switch\:bg-green-300{--tw-bg-opacity: 1;background-color:rgb(0 214 171 / var(--tw-bg-opacity, 1))}.group\/switch[data-checked=true] .group-data-\[checked\=true\]\/switch\:bg-primary-400{--tw-bg-opacity: 1;background-color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-bg-opacity, 1))}.group\/input-root[data-invalid=true] .group-data-\[invalid\=true\]\/input-root\:bg-base-200{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-200, 246 245 250) / var(--tw-bg-opacity, 1))}.group\/sidebar[data-type=light] .group-data-\[type\=\"light\"\]\/sidebar\:bg-base-100{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-100, 255 255 255) / var(--tw-bg-opacity, 1))}.group\/tooltip[data-type=default] .group-data-\[type\=\"default\"\]\/tooltip\:fill-base-600{fill:rgba(var(--color-base-600, 0 8 82) / 1)}.group\/tooltip[data-type=error] .group-data-\[type\=\"error\"\]\/tooltip\:fill-red-300{fill:#ed315d}.group\/tooltip[data-type=success] .group-data-\[type\=\"success\"\]\/tooltip\:fill-green-400{fill:#0fa388}.group\/sidebar[data-state=collapsed] .group-data-\[state\=\"collapsed\"\]\/sidebar\:px-1{padding-left:.25rem;padding-right:.25rem}.group\/chip[data-size=big] .group-data-\[size\=\"big\"\]\/chip\:text-\[13px\]{font-size:13px}.group\/chip[data-size=medium] .group-data-\[size\=\"medium\"\]\/chip\:text-\[12px\]{font-size:12px}.group\/chip[data-size=small] .group-data-\[size\=\"small\"\]\/chip\:text-xs{font-size:.75rem;line-height:1rem}.group\/dropdown-item[data-size=m] .group-data-\[size\=m\]\/dropdown-item\:\!text-\[15px\]{font-size:15px!important}.group\/dropdown-item[data-size=s] .group-data-\[size\=s\]\/dropdown-item\:text-xs{font-size:.75rem;line-height:1rem}.group\/dropdown-wordtrigger[data-disabled] .group-data-\[disabled\]\/dropdown-wordtrigger\:text-base-400{--tw-text-opacity: 1;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))}.group\/combobox-root[data-invalid=true] .group-data-\[invalid\=true\]\/combobox-root\:text-red-300,.group\/input-root[data-invalid=true] .group-data-\[invalid\=true\]\/input-root\:text-red-300{--tw-text-opacity: 1;color:rgb(237 49 93 / var(--tw-text-opacity, 1))}.group\/banner[data-type=secondary] .group-data-\[type\=\"secondary\"\]\/banner\:text-base-100{--tw-text-opacity: 1;color:rgba(var(--color-base-100, 255 255 255) / var(--tw-text-opacity, 1))}.group\/chip[data-variant=primary] .group-data-\[variant\=\"primary\"\]\/chip\:text-primary-400{--tw-text-opacity: 1;color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-text-opacity, 1))}.group\/chip[data-variant=secondary] .group-data-\[variant\=\"secondary\"\]\/chip\:text-base-400{--tw-text-opacity: 1;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))}.group\/chip[data-variant=success] .group-data-\[variant\=\"success\"\]\/chip\:text-green-400{--tw-text-opacity: 1;color:rgb(15 163 136 / var(--tw-text-opacity, 1))}.group\/chip[data-variant=tertiary] .group-data-\[variant\=\"tertiary\"\]\/chip\:text-base-300{--tw-text-opacity: 1;color:rgba(var(--color-base-300, 227 226 237) / var(--tw-text-opacity, 1))}.group\/chip[data-variant=tertiary] .group-data-\[variant\=\"tertiary\"\]\/chip\:text-tertiary-300{--tw-text-opacity: 1;color:rgb(178 94 244 / var(--tw-text-opacity, 1))}.group\/input-root[data-disabled=true] .group-data-\[disabled\=true\]\/input-root\:opacity-50{opacity:.5}.group\/switch[data-checked=true] .group-data-\[checked\=true\]\/switch\:before\:translate-x-full:before{content:var(--tw-content);--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group\/sidebar[data-type=light] .group-data-\[type\=\"light\"\]\/sidebar\:hover\:bg-base-150:hover{--tw-bg-opacity: 1;background-color:rgba(var(--color-base-150, 250 250 255) / var(--tw-bg-opacity, 1))}.group\/input-root[data-invalid=true] .group-data-\[invalid\=true\]\/input-root\:focus\:border-red-300:focus{--tw-border-opacity: 1;border-color:rgb(237 49 93 / var(--tw-border-opacity, 1))}.group\/chip:hover[data-variant=primary] .group-hover\/chip\:group-data-\[variant\=\"primary\"\]\/chip\:text-primary-500{--tw-text-opacity: 1;color:rgba(var(--color-primary-500, 0 0 130) / var(--tw-text-opacity, 1))}.group\/chip:hover[data-variant=secondary] .group-hover\/chip\:group-data-\[variant\=\"secondary\"\]\/chip\:text-base-500{--tw-text-opacity: 1;color:rgba(var(--color-base-500, 90 93 141) / var(--tw-text-opacity, 1))}.group\/chip:hover[data-variant=success] .group-hover\/chip\:group-data-\[variant\=\"success\"\]\/chip\:text-green-500{--tw-text-opacity: 1;color:rgb(3 129 94 / var(--tw-text-opacity, 1))}.group\/chip:hover[data-variant=tertiary] .group-hover\/chip\:group-data-\[variant\=\"tertiary\"\]\/chip\:text-tertiary-400{--tw-text-opacity: 1;color:rgb(149 59 171 / var(--tw-text-opacity, 1))}.group\/sidebar[data-type=light] .group-data-\[type\=\"light\"\]\/sidebar\:aria-\[current\=page\]\:bg-primary-400\/10[aria-current=page]{background-color:rgba(var(--color-primary-400, 29 29 255) / .1)}.group\/sidebar[data-type=light] .group-data-\[type\=\"light\"\]\/sidebar\:aria-\[current\=page\]\:hover\:bg-primary-400\/20:hover[aria-current=page]{background-color:rgba(var(--color-primary-400, 29 29 255) / .2)}@media not all and (min-width: 1024px){.group\/sidebar:hover .max-lg\:group-hover\/sidebar\:\!px-4{padding-left:1rem!important;padding-right:1rem!important}.group\/sidebar[data-state=default] .max-lg\:group-data-\[state\=\"default\"\]\/sidebar\:hidden{display:none}}@media not all and (min-width: 768px){.group\/sidebar:hover .group-hover\/sidebar\:max-md\:\!px-4{padding-left:1rem!important;padding-right:1rem!important}.group\/sidebar[data-state=default] .max-md\:group-data-\[state\=\"default\"\]\/sidebar\:justify-center{justify-content:center}.group\/sidebar[data-state=default] .max-md\:group-data-\[state\=\"default\"\]\/sidebar\:px-1{padding-left:.25rem;padding-right:.25rem}}@media (min-width: 768px){.md\:text-\[15px\]{font-size:15px}.md\:text-\[16px\]{font-size:16px}.md\:text-\[21px\]{font-size:21px}.md\:text-\[24px\]{font-size:24px}.md\:text-\[28px\]{font-size:28px}.md\:text-\[36px\]{font-size:36px}.md\:text-\[52px\]{font-size:52px}.md\:leading-\[1\.16\]{line-height:1.16}.md\:leading-\[1\.25\]{line-height:1.25}.md\:leading-\[1\.2\]{line-height:1.2}.md\:leading-\[1\.4\]{line-height:1.4}.md\:tracking-\[-1\%\]{letter-spacing:-1%}.md\:tracking-\[-2\%\]{letter-spacing:-2%}.md\:tracking-\[-3\%\]{letter-spacing:-3%}.group\/sidebar[data-state=default] .md\:group-data-\[state\=\"default\"\]\/sidebar\:hidden{display:none}}.\[\&\>\*\]\:outline-none>*{outline:2px solid transparent;outline-offset:2px}.data-\[attached\=true\]\:\[\&\>not\(\:first-child\,_\:last-child\)\]\:rounded-none>not(:first-child,:last-child)[data-attached="true"]{border-radius:0}.\[\&\>span\]\:\!text-base-100>span{--tw-text-opacity: 1 !important;color:rgba(var(--color-base-100, 255 255 255) / var(--tw-text-opacity, 1))!important}.\[\&\>span\]\:\!no-underline>span{text-decoration-line:none!important}.\[\&\>svg\]\:gap-xs>svg{gap:.25rem}.\[\&_\>_div_\>_p\]\:data-\[disabled\]\:text-base-400[data-disabled]>div>p{--tw-text-opacity: 1;color:rgba(var(--color-base-400, 176 174 208) / var(--tw-text-opacity, 1))}.\[\&_button\>span\]\:text-base-500 button>span{--tw-text-opacity: 1;color:rgba(var(--color-base-500, 90 93 141) / var(--tw-text-opacity, 1))}.\[\&_button\>span\]\:text-orange-400 button>span{--tw-text-opacity: 1;color:rgb(255 107 70 / var(--tw-text-opacity, 1))}.\[\&_button\>span\]\:text-white button>span{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.\[\&_button\>svg\]\:text-base-100 button>svg{--tw-text-opacity: 1;color:rgba(var(--color-base-100, 255 255 255) / var(--tw-text-opacity, 1))}.\[\&_button\>svg\]\:text-light-blue-400 button>svg{--tw-text-opacity: 1;color:rgb(0 141 255 / var(--tw-text-opacity, 1))}.\[\&_button\>svg\]\:text-orange-400 button>svg{--tw-text-opacity: 1;color:rgb(255 107 70 / var(--tw-text-opacity, 1))}.\[\&_button\>svg\]\:text-primary-400 button>svg{--tw-text-opacity: 1;color:rgba(var(--color-primary-400, 29 29 255) / var(--tw-text-opacity, 1))}.\[\&_button\>svg\]\:text-purple-300 button>svg{--tw-text-opacity: 1;color:rgb(178 94 244 / var(--tw-text-opacity, 1))}.\[\&_button\]\:decoration-base-100 button{text-decoration-color:rgba(var(--color-base-100, 255 255 255) / 1)}.\[\&_button\]\:decoration-orange-400 button{text-decoration-color:#ff6b46}*{font-family:Work Sans,sans-serif}</style></head><body><div></div></body></html></template></tldx-lmi-shadow-root><div id="tldx-toast-container"></div><div class="glasp-extension-toaster" style="display: block; width: 320px; margin: unset; padding: unset; border: unset; border-radius: unset; outline: unset; background-color: unset; box-shadow: unset; position: fixed; top: 40px; right: 24px; z-index: 9999;"><template shadowrootmode="open"><div class="glasp-extension" style="font-family: inherit;"></div></template></div></body><div class="glasp-extension" style="display: block; width: unset; margin: unset; padding: unset; border: unset; border-radius: unset; outline: unset; background-color: unset; box-shadow: unset; position: fixed; bottom: 16px; right: 16px; z-index: 9999;"><div class="glasp-extension" style="font-family: inherit;"></div></div></html>
